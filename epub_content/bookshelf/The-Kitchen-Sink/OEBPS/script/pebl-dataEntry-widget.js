var globalPebl="object"==typeof globalPebl?globalPebl:{};globalPebl.extension=globalPebl.extension||{},globalPebl.extension.PeblDataEntryWidget=function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/dist/",s(s.s=4)}([function(t,e){t.exports=Vue},function(t,e,s){var i=s(2);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,s(5).default)("917b5598",i,!0,{})},function(t,e,s){(t.exports=s(3)(!1)).push([t.i,'.dataEntryWrapper{break-inside:avoid-column;padding:1rem 0rem;-webkit-column-break-inside:avoid}.dataEntryCfiPlaceholder{margin:0 !important;padding:0 !important;color:transparent !important;font-size:1px !important;line-height:0 !important}.dataEntryCallout,.dataEntrySubFormCallout{background-color:var(--background-lighter);width:calc(100% - 2px);margin:0;clear:both;overflow:hidden;break-inside:avoid-column;-webkit-column-break-inside:avoid;display:flex;flex-direction:column;-webkit-transform:translateX(0)}.dataEntryCallout.edit input[type=radio]{display:inline-block}.dataEntryCallout input[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:2px solid var(--secondary-color-dark);background-color:transparent;color:var(--light-font);height:2em;width:2em;border-radius:1000px;cursor:pointer;outline:none;margin-right:7px;transition:all var(--transition-fast)}.dataEntryCallout input[type=radio]:hover{background-color:var(--secondary-color-dark)}.dataEntryCallout input[type=radio]:checked{background-color:var(--secondary-color-dark)}.dataEntryCallout input[type=radio]:checked::before{content:"\\2143";position:absolute;font:1em/1 "Open Sans",sans-serif;left:8px;top:5px;transform:rotate(40deg)}.dataEntryTableContainer table input[type=radio]{left:0;right:0;margin-left:auto;margin-right:auto}.dataEntryCallout::after{content:" ";display:block;height:0;clear:both}.dataEntryCallout p{font-weight:600;font-size:1.1em;font-family:var(--font-family-secondary);margin:0;padding:0}.dataEntryHeader{font-size:.9em;display:flex;justify-content:space-around;align-items:center;color:var(--dark-font);order:1}.dataEntryHeader>div{width:100%;background:var(--background-light);text-align:center;padding:var(--spacing-xs);cursor:pointer}.dataEntryHeader>div:hover{background:var(--secondary-color-dark) !important;color:var(--light-font)}.dataEntryHeader>div.active{color:var(--light-font);background:var(--secondary-color-light)}.dataEntryFooter>button:hover{background:var(--primary-color-dark)}.dataEntryCallout form{max-height:calc(70vh - 192px);overflow:auto;order:2;min-height:80px}.dataEntryCallout form.fixScrolling,.dataEntrySubFormCallout form.fixScrolling{will-change:transform}.dataEntryCallout form>.textBox,.dataEntryCallout form>.dataEntryTableContainer,.dataEntrySubFormCallout form>.textBox,.dataEntryCallout form>.dataEntryHeaderEntry,.dataEntryCallout form>.dataEntryCheckboxContainer{padding:0 var(--spacing);margin-bottom:var(--spacing)}.dataEntryCallout form>p,.dataEntrySubFormCallout form>p{padding:1em}.dataEntryFooter{border-top:1px solid var(--background-darker);display:flex;align-items:center;justify-content:space-around;width:100%;min-height:10px;margin-top:var(--spacing-s);padding:var(--spacing-s);order:3}.dataEntryFooter>button{width:100%;color:#fff;background:var(--primary-color);padding:.5em 0em;margin:.5em;border:none;font-size:.9em;cursor:pointer}.textInput label,.dataEntryFileInputEditContainer label{display:block;margin:1em 0 0 0;font-weight:400;font-size:.9rem;font-family:var(--font-family-secondary)}.textResponses{display:block;max-height:280px;box-sizing:border-box;padding:0;margin-top:1em;margin-left:-1em;margin-right:-1em;overflow:auto;-webkit-overflow-scrolling:touch;font-family:var(--font-family-secondary);font-style:normal;font-weight:normal;font-size:14px;border-top:1px solid #ddd;border-bottom:1px solid #ddd;clear:both}.dataEntryTextResponseNoData{margin-top:1em !important;margin-left:2em !important;margin-bottom:1em !important}.textResponses>.response:not([style*="display: none"])~.dataEntryTextResponseNoData{display:none}.textResponses .response,.dataEntryCheckboxContainer .response{position:relative;padding:.8em 1em .5em 3em;margin:0;background:#eee;border-bottom:1px solid #ddd}.textResponses .response>i,.dataEntryCheckboxContainer .response>i{position:absolute;left:.5em;font-size:1.5em}.textResponses .showMore{display:block;padding:1em;padding-left:80px;margin:0;font-style:italic}.textResponses .your.response,.dataEntryCheckboxContainer .your.response{background-color:var(--background-light)}.textResponses .response .userId,.dataEntryCheckboxContainer .response .userId{font-weight:bold}.textResponses .response .timestamp,.dataEntryCheckboxContainer .response .timestamp{margin-left:.5em;font-size:.75em;color:#999}.textResponses .response .message,.dataEntryCheckboxContainer .response .message{font-style:normal;font-family:var(--font-family-secondary);font-weight:normal;margin:.5em 0}.dataEntryCheckboxContainer{display:flex;align-items:center;justify-content:space-between}.dataEntryCheckboxContainer>span{padding:.5em;width:100%}.dataEntryCheckboxContainer>input[type=checkbox]{will-change:transform;-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5);transform:scale(1.5);padding:10px;margin:1em}.dataEntryCheckboxResponseContainer{padding:.5em;max-width:50%;font-family:var(--font-family-secondary);font-style:normal;font-weight:normal;font-size:14px;flex-shrink:0}.dataEntryCheckboxResponseContainer>span{display:block}.dataEntryDropdownContainer{padding-left:1em;padding-right:1em;margin-bottom:1em}.dataEntryDropdownContainer select{max-width:90%;margin-left:1em}.dataEntryDropdownContainer .textResponses{margin-top:2em}.dataEntrySubFormCallout{display:none;position:fixed;background-color:var(--background-light);top:60px;left:0;max-height:calc(100% - 70px);overflow:auto}.dataEntryMultiChoiceContainer{padding-left:1em;padding-right:1em}.dataEntryMultiChoiceButtonsContainer{display:flex;flex-direction:column;font-family:var(--font-family-secondary)}.dataEntryMultiChoiceButton{margin:1px 0;padding:1em;text-align:left;background:var(--background-darker)}.dataEntryMultiChoiceButton.active{background:var(--secondary-color-light);color:var(--light-font)}.dataEntryMultiChoiceButton:hover{background:var(--secondary-color);color:#fff}.dataEntryMultiChoiceResponse{margin:.5em}.dataEntryMultiChoiceResponseContent{display:flex}.dataEntryMultiChoiceResponseTextContainer{width:50%}.dataEntryMultiChoiceResponseGraphContainer{width:50%;padding-left:1em;box-sizing:border-box}.dataEntryMultiChoiceResponseGraphParentBar{background:rgba(0,0,0,.1);width:100%;height:1em;position:relative;border-radius:1000px}.dataEntryMultiChoiceResponseGraphFillBar{background:var(--secondary-color);height:100%;width:0;float:right;border-radius:1000px;transition:width .5s ease}.dataEntryMultiChoiceResponseCount{margin-left:1em}.pollingWindow{background:var(--background-light);position:fixed;top:0;left:0;right:0;margin:1em;z-index:9999;display:flex;justify-content:center;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}.pollingWindow>.dataEntryCallout{width:100% !important;font-family:var(--font-family-secondary)}.pollingWindow form>p{font-weight:bold;font-size:1.2em;font-family:var(--font-family-secondary)}.pollingWindow .dataEntryMultiChoiceButton{font-size:1em;font-weight:bold;padding:1em}.pollingWindow .dataEntryFormSubmit{font-weight:bold;font-size:1.2em}.pollingWindow .dataEntryCallout{max-height:calc(100vh - 105px)}.pollingWindow .dataEntryCallout form{max-height:calc(100vh - 192px)}.showInlineMakeOfficial .inlineMakeOfficialContainer{display:flex;align-items:center}.inlineMakeOfficialContainer{display:none;color:var(--primary-color)}.dataEntryTableContainer table th{font-weight:500;font-family:var(--font-family-secondary);font-size:.9em;color:var(--background-darker);text-align:center;padding:.5em}.dataEntryTableContainer table td{background:transparent;text-align:center;padding:.5em}.dataEntryFileInputContainer{padding:1em}.dataEntryFileInputQueuedResponses{display:flex;flex-direction:column;margin-top:1em}.dataEntryFileInputResponse{display:flex;align-items:center;margin-bottom:1em}.dataEntryFileInputResponseIcon{color:var(--primary-color-light)}.dataEntryFileInputResponseDeleteIcon{color:#575757;cursor:pointer}.dataEntryFileInputDownloadIcon{color:#575757;cursor:pointer}.dataEntryFileInputResponseTextContainer{display:flex;flex-direction:column;width:100%;overflow:hidden;padding-left:1em;padding-right:1em}.dataEntryFileInputResponseTextContainerMedia{display:flex;width:100%;overflow:hidden;justify-content:space-between}.dataEntryFileInputResponseText{font-weight:bold;overflow:hidden;text-overflow:ellipsis}.dataEntryFileInputDropZone{border:dashed 2px gray;border-radius:5px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1em;margin-bottom:1em}.dataEntryFileInputDropZone i{margin-bottom:.5em;color:gray}.dataEntryFileInputDropZone.dragging{opacity:.5}.dataEntryFileInputDropZoneLink{text-decoration:unerline;text-decoration-color:var(--primary-color);color:var(--primary-color);cursor:pointer}.dataEntryFileInputDropZone input{display:none}.dataEntryFileInputImagePreview{width:100%}.dataEntryFileInputVideoPreview{width:100%}.dataEntryFileInputPreviewContainer{margin-top:1em}.dataEntryClickableSpan{color:var(--primary-color);text-decoration-color:var(--primary-color);text-decoration:underline;cursor:pointer}',""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s=function(t,e){var s=t[1]||"",i=t[3];if(!i)return s;if(e&&"function"==typeof btoa){var o=(n=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),a=i.sources.map((function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"}));return[s].concat(a).concat([o]).join("\n")}var n;return[s].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+s+"}":s})).join("")},e.i=function(t,s){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(i[a]=!0)}for(o=0;o<t.length;o++){var n=t[o];"number"==typeof n[0]&&i[n[0]]||(s&&!n[2]?n[2]=s:s&&(n[2]="("+n[2]+") and ("+s+")"),e.push(n))}},e}},function(t,e,s){"use strict";s.r(e);s(1);var i=s(0),o=s.n(i);var a=function(t,e,s,i,o,a,n,r){var l=typeof(t=t||{}).default;"object"!==l&&"function"!==l||(t=t.default);var d,p="function"==typeof t?t.options:t;if(e&&(p.render=e,p.staticRenderFns=s,p._compiled=!0),i&&(p.functional=!0),a&&(p._scopeId=a),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},p._ssrRegister=d):o&&(d=r?function(){o.call(this,this.$root.$options.shadowRoot)}:o),d)if(p.functional){p._injectStyles=d;var c=p.render;p.render=function(t,e){return d.call(e),c(t,e)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,d):[d]}return{exports:t,options:p}}(o.a.extend({name:"Widget",props:["globalPebl","globalReadium","globalConfiguration","globalLightbox","insertID","prompt","id","forms","sharing","displayMode","polling","multiSelectPolling","useConfig","closeable","propertiesObject"],mounted(){if(this.globalPebl&&this.globalPebl.extension.config&&this.globalPebl.extension.config.dataEntry){let t=this.globalPebl.extension.config.dataEntry;t.formSubmitButtonText&&(this.formSubmitButtonText=t.formSubmitButtonText),t.formSubmitTeamButtonText&&(this.formSubmitTeamButtonText=t.formSubmitTeamButtonText),t.formSubmitClassButtonText&&(this.formSubmitClassButtonText=t.formSubmitClassButtonText),t.viewModeButtonText&&(this.viewModeButtonText=t.viewModeButtonText),t.teamViewModeButtonText&&(this.teamViewModeButtonText=t.teamViewModeButtonText),t.classViewModeButtonText&&(this.classViewModeButtonText=t.classViewModeButtonText),t.teamViewResponsesText&&(this.modeTextMap.viewPara.teamView=t.teamViewResponsesText),t.classViewResponsesText&&(this.modeTextMap.viewPara.classView=t.classViewResponsesText)}let t=this.sharing;for(let t=0;t<this.forms.length;t++){let e=this.forms[t];"text"===e.type?this.initTextEntry(this.comboID(this.id,t.toString()),e.prompt):"file"===e.type&&this.initFileEntry(this.comboID(this.id,t.toString()),e.prompt)}this.globalPebl.user.getUser(e=>{this.userProfile=e;let s=this.dataMessageHandler(this.id);"private"===this.sharing?(e&&this.globalPebl.subscribeThread(this.id,!1,s,{isPrivate:!0}),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledFooterButtons,"formSubmitPrivate",!0)):"private+email"===this.sharing?(e&&this.globalPebl.subscribeThread(this.id,!1,s,{isPrivate:!0}),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledFooterButtons,"formSubmitEmail",!0)):"private+all"===this.sharing?(e&&(this.globalPebl.subscribeThread(this.id,!1,s),this.globalPebl.subscribeThread(this.id,!1,s,{isPrivate:!0})),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitPrivate",!0),this.$set(this.enabledFooterButtons,"formSubmit",!0)):"team+class"===this.sharing?e&&!e.currentClass?t="team":e&&!e.currentTeam?t="class":(e&&(this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentTeam}),this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentClass})),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam",!0),this.$set(this.enabledFooterButtons,"formSubmitClass",!0)):"team+all"===this.sharing&&(e&&!e.currentTeam?t="class+all":(e&&(this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentTeam}),this.globalPebl.subscribeThread(this.id,!1,s)),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam+All",!0))),"class+all"===t&&(e&&!e.currentClass?t="all":(e&&(this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentClass}),this.globalPebl.subscribeThread(this.id,!1,s)),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitClass+All",!0))),"team"===t&&(e&&!e.currentTeam?t="class":(e&&this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentTeam}),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam",!0))),"class"===t&&(e&&!e.currentClass?t="all":(e&&this.globalPebl.subscribeThread(this.id,!1,s,{groupId:e.currentClass}),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledFooterButtons,"formSubmitClass",!0))),"all"===t&&(e&&this.globalPebl.subscribeThread(this.id,!1,s),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmit",!0)),"viewOnly"===this.displayMode&&("all"===t?this.viewMode():"team"===t?this.teamViewMode():"class"===t?this.classViewMode():"private"===t||"private+email"===t||"private+all"===t?this.privateViewMode():"team+class"===t||"team+all"===t?this.teamViewMode():"class+all"===t&&this.classViewMode())})},computed:{},data:()=>({userProfile:{},brTag:"<br/>",globalPebl:null,globalReadium:null,globalConfiguration:null,globalLightbox:null,insertID:"",prompt:"",id:"",forms:[],sharing:"",displayMode:"",polling:"",multiSelectPolling:1,useConfig:"",closeable:"",currentMode:"edit",invalidFormActive:!1,modeTextMap:{viewPara:{unofficialView:"View responses from other users below for this activity",teamView:"View your teamâ€˜s responses below for this activity.",classView:"View responses from the class below for this activity.",officialView:"View official responses below for this activity.",privateview:"View your private responses below for this activity."},textResponseNoData:{unoffialView:"Nothing has been submitted yet.",teamView:"Nothing has been submitted yet.",classView:"Nothing has been submitted yet.",officialView:"Nothing has been submitted yet.",privateView:"Nothing has been submitted yet."}},enabledHeaderButtons:{},enabledFooterButtons:{},editModeButtonText:"Participate",viewModeButtonText:"View Responses",classViewModeButtonText:"View Class Responses",teamViewModeButtonText:"View Team Responses",privateViewModeButtonText:"View Private Responses",formSubmitButtonText:"Share",formSubmitPrivateButtonText:"Submit Privately",formSubmitTeamButtonText:"Share with Team",formSubmitClassButtonText:"Share with Class",formSubmitEmailButtonText:"Email",activeMultiChoiceButton:{},pollCounts:{},messageModels:{},multiChoiceModels:{},fileUploadModels:{},messageResponses:{},multiChoiceResponses:{},fileResponses:{}}),methods:{initTextEntry:function(t,e){this.$set(this.messageModels,t,{mainPrompt:this.prompt,prompt:e,thread:t,text:"",type:"text"})},initFileEntry:function(t,e){this.$set(this.fileUploadModels,t,{mainPrompt:this.prompt,prompt:e,thread:t,text:[],files:[],type:"file"})},setFormType:function(t,e){this.$set(this.forms[t],"type",e),this.forms=JSON.parse(JSON.stringify(this.forms))},downloadFile:function(t){let e=document.createElement("a");e.setAttribute("style","display: none;"),e.href=t.objectUrl,e.download=t.name,document.body.appendChild(e),e.click(),document.body.removeChild(e)},fileIsImage:function(t){return t&&"image"===t.type.split("/")[0]},fileIsVideo:function(t){return t&&"video"===t.type.split("/")[0]},fileSize:function(t){var e=Math.floor(Math.log(t)/Math.log(1024));return 1*parseFloat((t/Math.pow(1024,e)).toFixed(2))+" "+["B","kB","MB","GB","TB"][e]},handleFileDrop:function(t,e,s){if(t.dataTransfer){let s=Array.from(t.dataTransfer.files),i=this.fileUploadModels[e].files.concat(s);this.$set(this.fileUploadModels[e],"files",i),this.$set(this.fileUploadModels[e],"text",i.map(t=>this.globalPebl.utils.getUuid()))}},updateFileModel:function(t,e,s){if(t.target&&t.target.files){let s=Array.from(t.target.files),i=this.fileUploadModels[e].files.concat(s);this.$set(this.fileUploadModels[e],"files",i),this.$set(this.fileUploadModels[e],"text",i.map(t=>this.globalPebl.utils.getUuid()))}},removeFileModel:function(t,e){this.fileUploadModels[e].files.splice(t,1),this.fileUploadModels[e].text.splice(t,1),this.$set(this.fileUploadModels,e,this.fileUploadModels[e])},getPollWidth:function(t,e){if(!this.pollCounts[t]||!this.pollCounts[t][e])return"0%";if(0===this.pollCounts[t][e])return"0%";if(!this.pollCounts[t].totalCount)return"0%";if(0===this.pollCounts[t].totalCount)return"0%";return(this.pollCounts[t][e]/this.pollCounts[t].totalCount*100).toString()+"%"},addScrollFix:function(){return!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)},setMultiChoiceResponse:function(t,e,s,i){if(this.multiSelectPolling){let o=!1;this.activeMultiChoiceButton[this.comboID(this.id,t.toString())]||this.$set(this.activeMultiChoiceButton,this.comboID(this.id,t.toString()),[]),this.multiChoiceModels[this.comboID(this.id,t.toString())]||this.$set(this.multiChoiceModels,this.comboID(this.id,t.toString()),{prompt:s.prompt,thread:this.comboID(this.id,t.toString()),useGraphView:this.polling,type:"multipleChoice",text:[],index:[]});for(let s=0;s<this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].length;s++)if(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())][s]===e){this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].splice(s,1),this.multiChoiceModels[this.comboID(this.id,t.toString())].text.splice(s,1),this.multiChoiceModels[this.comboID(this.id,t.toString())].index.splice(s,1),o=!0;break}!o&&this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].length<this.multiSelectPolling&&(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].push(e),Array.isArray(this.multiChoiceModels[this.comboID(this.id,t.toString())].text)||(this.multiChoiceModels[this.comboID(this.id,t.toString())].text=[]),Array.isArray(this.multiChoiceModels[this.comboID(this.id,t.toString())].index)||(this.multiChoiceModels[this.comboID(this.id,t.toString())].index=[]),this.multiChoiceModels[this.comboID(this.id,t.toString())].text.push(i),this.multiChoiceModels[this.comboID(this.id,t.toString())].index.push(e))}else this.$set(this.multiChoiceModels,this.comboID(this.id,t.toString()),{prompt:s.prompt,thread:this.comboID(this.id,t.toString()),useGraphView:this.polling,type:"multipleChoice"}),this.$set(this.activeMultiChoiceButton,this.comboID(this.id,t.toString()),[e]),this.multiChoiceModels[this.comboID(this.id,t.toString())].text=i,this.multiChoiceModels[this.comboID(this.id,t.toString())].index=e;console.log(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())])},comboID:function(...t){for(var e=null,s=0;s<arguments.length;s++){var i=arguments[s];e=null===e?i:e+"_"+i}return e},invalidForm:function(){this.invalidFormActive||(this.invalidFormActive=!0,window.alert("Please fill out the entire form"))},sortMessages:function(t,e){return new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()},dataMessageHandler:function(t){return t=>{this.globalPebl.user.getUser(e=>{if(e)for(let s of t){let t=JSON.parse(s.text);for(let i of t)i.timestamp=s.timestamp,i.id=this.comboID(s.id,i.thread),i.name=s.name,i.identity=s.actor.account.name,"text"===i.type?this.messageHandler(i,e):"file"===i.type?this.fileMessageHandler(i,e):"multipleChoice"===i.type&&("true"===i.useGraphView?"true"===this.multiSelectPolling?this.multiSelectPollingHandler(i,e):this.multiChoiceMessageHandler(i,e):this.messageHandler(i,e))}})}},getFileUrl:function(t){return(window.URL||window.webkitURL).createObjectURL(t)},fileMessageHandler:function(t,e){this.fileResponses[t.responseBox]||this.$set(this.fileResponses,t.responseBox,{});let s=this.fileResponses[t.responseBox][t.identity];if(s){if(new Date(t.timestamp)>new Date(s.timestamp)){let e=[];for(let s of t.text)e.push(this.globalPebl.storage.getAsset(s));Promise.all(e).then(e=>{e.map(t=>{Object.defineProperty(t,"objectUrl",{value:this.getFileUrl(t)})}),this.$set(this.fileResponses[t.responseBox],t.identity,t),this.$set(this.fileResponses[t.responseBox][t.identity],"files",e)})}}else{let e=[];for(let s of t.text)e.push(this.globalPebl.storage.getAsset(s));Promise.all(e).then(e=>{t.files=e.map(t=>{Object.defineProperty(t,"objectUrl",{value:this.getFileUrl(t)})}),this.$set(this.fileResponses[t.responseBox],t.identity,t),this.$set(this.fileResponses[t.responseBox][t.identity],"files",e)})}},messageHandler:function(t,e){t.mine=e.name===t.name,this.messageResponses[t.responseBox]||this.$set(this.messageResponses,t.responseBox,{});let s=this.messageResponses[t.responseBox][t.identity];s?new Date(t.timestamp)>new Date(s.timestamp)&&this.$set(this.messageResponses[t.responseBox],t.identity,t):this.$set(this.messageResponses[t.responseBox],t.identity,t)},multiSelectPollingHandler:function(t,e){this.multiChoiceResponses[t.responseBox]||this.$set(this.multiChoiceResponses,t.responseBox,{}),this.pollCounts[t.responseBox]||this.$set(this.pollCounts,t.responseBox,{totalCount:0});for(let e of t.index)this.pollCounts[t.responseBox][e]||this.$set(this.pollCounts[t.responseBox],e,0);let s=this.multiChoiceResponses[t.responseBox][t.identity];if(s){if(new Date(t.timestamp)>new Date(s.timestamp)){this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount-s.index.length),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+t.index.length);for(let e of s.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]-1);for(let e of t.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]+1)}}else{this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+t.index.length);for(let e of t.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]+1)}},multiChoiceMessageHandler:function(t,e){this.multiChoiceResponses[t.responseBox]||this.$set(this.multiChoiceResponses,t.responseBox,{}),this.pollCounts[t.responseBox]||this.$set(this.pollCounts,t.responseBox,{totalCount:0}),this.pollCounts[t.responseBox][t.index]||this.$set(this.pollCounts[t.responseBox],t.index,0);let s=this.multiChoiceResponses[t.responseBox][t.identity];s?new Date(t.timestamp)>new Date(s.timestamp)&&(this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),s.index!==t.index&&(this.$set(this.pollCounts[t.responseBox],s.index,this.pollCounts[t.responseBox][s.index]-1),this.$set(this.pollCounts[t.responseBox],t.index,this.pollCounts[t.responseBox][t.index]+1))):(this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+1),this.$set(this.pollCounts[t.responseBox],t.index,this.pollCounts[t.responseBox][t.index]+1))},editMode:function(){this.currentMode="edit",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},viewMode:function(){this.currentMode="unofficialView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},privateViewMode:function(){this.currentMode="privateView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},teamViewMode:function(){this.currentMode="teamView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},classViewMode:function(){this.currentMode="classView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},getFormData:function(t){this.invalidFormActive=!1;let e=[];e=e.concat(Object.values(this.messageModels),Object.values(this.multiChoiceModels),Object.values(this.fileUploadModels));for(let s of e)if(s.responseBox=this.comboID(s.thread,t),"multipleChoice"===s.type&&"true"===this.polling)if(s.responseBox=this.comboID(s.responseBox,"graph"),"true"===this.multiSelectPolling)for(let t of s.text)this.globalPebl.emitEvent(this.globalPebl.events.eventPreferred,{activityType:"poll",activityId:this.id,name:s.prompt,description:t});else this.globalPebl.emitEvent(this.globalPebl.events.eventPreferred,{activityType:"poll",activityId:this.id,name:s.prompt,description:s.text});else if("file"===s.type)for(let t=0;t<s.files.length;t++)this.globalPebl.storage.saveAsset(s.text[t],s.files[t],()=>{this.globalPebl.emitEvent(this.globalPebl.events.eventUploadedMedia,{activityType:"data-entry",activityId:this.id,name:s.prompt,description:s.text[t],mediaId:s.text[t]})});return e},sendMessage:function(t,e,s,i){let o=this.getFormData(t);o.length>0&&this.globalPebl.storage.getCurrentBookTitle(t=>{let a={prompt:this.prompt,thread:this.id,text:JSON.stringify(o),additionalResultData:{subResponses:o.map(t=>({prompt:t.prompt,response:t.text}))},isPrivate:e,groupId:s,book:t,activityType:"true"===this.polling?"poll":"data-entry",activityId:this.id,cfi:void 0,idRef:void 0};if(this.globalReadium){let t=this.globalReadium.reader.bookmarkCurrentPage();t&&(t=JSON.parse(t),a.cfi=t.contentCFI,a.idRef=t.idref)}this.globalPebl&&this.globalPebl.emitEvent(this.globalPebl.events.newMessage,a),i(a)})},formSubmit:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBox",!1,void 0,()=>{this.viewMode()})})},formSubmitPrivate:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBoxPrivate",!0,void 0,()=>{this.privateViewMode()})})},formSubmitEmail:function(){let t=this.getFormData("responseBoxPrivate");if(t.length>0){let e={prompt:this.prompt,thread:this.id,text:JSON.stringify(t),additionalResultData:{subResponses:t.map(t=>({prompt:t.prompt,response:t.text}))},isPrivate:!0,book:this.globalPebl.extension.config.bookTitle},s="mailto:?subject="+encodeURI(e.book)+"&body=";s+=encodeURI(e.prompt+"\r\n\r\n");for(let t of e.additionalResultData.subResponses)s+=encodeURI(t.prompt+"\r\n"),s+=encodeURI(t.response+"\r\n\r\n");let i=document.createElement("form");i.setAttribute("style","display: none"),i.target="_blank",i.action=s,i.method="post",document.body.appendChild(i),i.submit(),document.body.removeChild(i)}this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBoxPrivate",!0,void 0,t=>{this.privateViewMode()})})},formSubmitTeam:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxTeam",!1,t.currentTeam,()=>{this.teamViewMode()})})})},formSubmitClass:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxClass",!1,t.currentClass,()=>{this.classViewMode()})})})},formSubmitTeamAll:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxTeam",!1,t.currentTeam,()=>{this.sendMessage("responseBox",!1,void 0,()=>{this.teamViewMode()})})})})},formSubmitClassAll:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxClass",!1,t.currentClass,()=>{this.sendMessage("responseBox",!1,void 0,()=>{this.classViewMode()})})})})}}}),(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dataEntryWrapper",attrs:{"data-theme-target":t.insertID,contenteditable:"false","data-propertiesobject":t.propertiesObject}},[s("p",{staticClass:"dataEntryCfiPlaceholder"},[t._v("CFI")]),t._v(" "),s("div",{staticClass:"dataEntryCallout"},[s("form",{class:{fixScrolling:t.addScrollFix()}},[s("p",{staticClass:"dataEntryMainPrompt",style:{"display: none;":!t.prompt||0===t.prompt.length}},[t._v(t._s(t.prompt?t.prompt.replace(/\&/g," and "):""))]),t._v(" "),t.modeTextMap.viewPara[t.currentMode]?s("p",{class:t.currentMode},[t._v(t._s(t.modeTextMap.viewPara[t.currentMode]))]):t._e(),t._v(" "),t._l(t.forms,(function(e,i){return["text"===e.type?s("div",{key:e,staticClass:"textBox"},[s("div",{staticClass:"textInput",class:e.cssClass},[s("label",[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.messageModels[t.comboID(t.id,i)].text,expression:"messageModels[comboID(id, index)].text"}],staticClass:"edit",attrs:{required:!!e.required&&"required",oninvalid:t.invalidForm,placeholder:e.placeholder?e.placeholder.replace(/\&/g," and "):"",id:t.comboID(t.id,i)},domProps:{value:t.messageModels[t.comboID(t.id,i)].text},on:{input:function(e){e.target.composing||t.$set(t.messageModels[t.comboID(t.id,i)],"text",e.target.value)}}}):t._e(),t._v(" "),e.allowMediaUpload&&"edit"===t.currentMode?s("span",{staticClass:"dataEntryClickableSpan",on:{click:function(s){t.setFormType(i,"file"),t.initFileEntry(t.comboID(t.id,i.toString()),e.prompt)}}},[t._v("Upload File")]):t._e()]),t._v(" "),"unofficialView"===t.currentMode?s("div",{staticClass:"textResponses unofficialView",attrs:{id:t.comboID(t.id,i,"responseBox")}},[t.messageResponses[t.comboID(t.id,i,"responseBox")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,i,"responseBox")]).sort(t.sortMessages),(function(e){return s("div",{key:e,staticClass:"response",class:{your:e.mine}},[s("i",{staticClass:"fa fa-user"}),t._v(" "),s("span",{staticClass:"userId"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"timestamp"},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),s("p",{staticClass:"message"},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),s("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.unofficialView))])],2):t._e(),t._v(" "),"officialView"===t.currentMode?s("div",{staticClass:"textResponses officialView",attrs:{id:t.comboID(t.id,i,"responseBoxOfficial")}},[t.messageResponses[t.comboID(t.id,i,"responseBoxOfficial")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,i,"responseBoxOfficial")]).sort(t.sortMessages),(function(e){return s("div",{key:e,staticClass:"response",class:{your:e.mine}},[s("i",{staticClass:"fa fa-user"}),t._v(" "),s("span",{staticClass:"userId"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"timestamp"},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),s("p",{staticClass:"message"},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),s("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.officialView))])],2):t._e(),t._v(" "),"privateView"===t.currentMode?s("div",{staticClass:"textResponses privateView",attrs:{id:t.comboID(t.id,i,"responseBoxPrivate")}},[t.messageResponses[t.comboID(t.id,i,"responseBoxPrivate")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,i,"responseBoxPrivate")]).sort(t.sortMessages),(function(e){return s("div",{key:e,staticClass:"response",class:{your:e.mine}},[s("i",{staticClass:"fa fa-user"}),t._v(" "),s("span",{staticClass:"userId"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"timestamp"},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),s("p",{staticClass:"message"},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),s("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.privateView))])],2):t._e(),t._v(" "),"teamView"===t.currentMode?s("div",{staticClass:"textResponses teamView",attrs:{id:t.comboID(t.id,i,"responseBoxTeam")}},[t.messageResponses[t.comboID(t.id,i,"responseBoxTeam")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,i,"responseBoxTeam")]).sort(t.sortMessages),(function(e){return s("div",{key:e,staticClass:"response",class:{your:e.mine}},[s("i",{staticClass:"fa fa-user"}),t._v(" "),s("span",{staticClass:"userId"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"timestamp"},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),s("p",{staticClass:"message"},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),s("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.teamView))])],2):t._e(),t._v(" "),"classView"===t.currentMode?s("div",{staticClass:"textResponses classView",attrs:{id:t.comboID(t.id,i,"responseBoxClass")}},[t.messageResponses[t.comboID(t.id,i,"responseBoxClass")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,i,"responseBoxClass")]).sort(t.sortMessages),(function(e){return s("div",{key:e,staticClass:"response",class:{your:e.mine}},[s("i",{staticClass:"fa fa-user"}),t._v(" "),s("span",{staticClass:"userId"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"timestamp"},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),s("p",{staticClass:"message"},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),s("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.classView))])],2):t._e()]):t._e(),t._v(" "),"file"===e.type?s("div",{key:e,staticClass:"dataEntryFileInputContainer"},[s("div",{staticClass:"dataEntryFileInputEditContainer",class:e.cssClass},[s("label",[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode&&t.fileUploadModels[t.comboID(t.id,i)]?s("div",{staticClass:"dataEntryFileInputQueuedResponses"},[t._l(t.fileUploadModels[t.comboID(t.id,i)].files,(function(e,o){return s("div",{key:e.name,staticClass:"dataEntryFileInputResponse"},[s("i",{staticClass:"fa fa-file fa-3x dataEntryFileInputResponseIcon"}),t._v(" "),s("div",{staticClass:"dataEntryFileInputResponseTextContainer"},[s("span",{staticClass:"dataEntryFileInputResponseText"},[t._v(t._s(e.name))]),t._v(" "),s("span",[t._v(t._s(t.fileSize(e.size)))])]),t._v(" "),s("i",{staticClass:"fa fa-times fa-2x dataEntryFileInputResponseDeleteIcon",on:{click:function(e){t.removeFileModel(o,t.comboID(t.id,i))}}})])})),t._v(" "),e.allowMediaUpload?s("span",{staticClass:"dataEntryClickableSpan",on:{click:function(s){t.setFormType(i,"text"),t.initTextEntry(t.comboID(t.id,i.toString()),e.prompt)}}},[t._v("Enter Text Response")]):t._e()],2):t._e(),t._v(" "),"edit"===t.currentMode?s("div",{staticClass:"dataEntryFileInputDropZone",on:{drop:function(s){s.preventDefault(),t.handleFileDrop(s,t.comboID(t.id,i),e.prompt)}}},[s("input",{ref:"fileInput-"+t.comboID(t.id,i),refInFor:!0,attrs:{required:!!e.required&&"required",oninvalid:t.invalidForm,id:t.comboID(t.id,i),type:"file",multiple:""},on:{change:function(s){t.updateFileModel(s,t.comboID(t.id,i),e.prompt)}}}),t._v(" "),s("i",{staticClass:"fa fa-file-upload fa-3x"}),t._v(" "),s("span",[t._v("Drag and drop files here or "),s("span",{staticClass:"dataEntryFileInputDropZoneLink",on:{click:function(e){t.$refs["fileInput-"+t.comboID(t.id,i)][0].click()}}},[t._v("browse")]),t._v(" your files.")])]):t._e(),t._v(" "),"privateView"===t.currentMode?s("div",{staticClass:"dataEntryFileInputPreviewContainer"},[t.fileResponses[t.comboID(t.id,i,"responseBoxPrivate")]&&t.fileResponses[t.comboID(t.id,i,"responseBoxPrivate")][t.userProfile.identity]?[t._l(t.fileResponses[t.comboID(t.id,i,"responseBoxPrivate")][t.userProfile.identity].files,(function(e){return[t.fileIsImage(e)?s("img",{key:e,staticClass:"dataEntryFileInputImagePreview",attrs:{src:e.objectUrl}}):t._e(),t._v(" "),t.fileIsVideo(e)?s("video",{key:e,staticClass:"dataEntryFileInputVideoPreview",attrs:{controls:"controls"}},[s("source",{attrs:{src:e.objectUrl,type:e.type}})]):t._e(),t._v(" "),s("div",{key:e,staticClass:"dataEntryFileInputResponse"},[t.fileIsImage(e)||t.fileIsVideo(e)?t._e():s("i",{staticClass:"fa fa-file fa-3x dataEntryFileInputResponseIcon"}),t._v(" "),s("div",{class:{dataEntryFileInputResponseTextContainerMedia:t.fileIsImage(e)||t.fileIsVideo(e),dataEntryFileInputResponseTextContainer:!t.fileIsImage(e)&&!t.fileIsVideo(e)}},[s("span",{staticClass:"dataEntryFileInputResponseText"},[t._v(t._s(e.name))]),t._v(" "),s("span",[t._v(t._s(t.fileSize(e.size)))])]),t._v(" "),t.fileIsImage(e)||t.fileIsVideo(e)?t._e():s("i",{staticClass:"fa fa-download fa-2x dataEntryFileInputDownloadIcon",on:{click:function(s){return t.downloadFile(e)}}})]),t._v(" "),s("hr",{key:e})]}))]:t._e(),t._v(" "),0===t.fileUploadModels[t.comboID(t.id,i)].files.length?s("p",{staticClass:"dataEntryFileUploadNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.privateView))]):t._e()],2):t._e()])]):t._e(),t._v(" "),"multipleChoice"===e.type?s("div",{key:e,staticClass:"dataEntryMultiChoiceContainer"},[s("div",{staticClass:"dataEntryMultiChoicePrompt"},[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode?s("div",{staticClass:"dataEntryMultiChoiceButtonsContainer",attrs:{id:t.comboID(t.id,i)}},t._l(e.responses,(function(o,a){return s("button",{key:o,staticClass:"dataEntryMultiChoiceButton edit",class:{active:t.activeMultiChoiceButton[t.comboID(t.id,i)]&&t.activeMultiChoiceButton[t.comboID(t.id,i)].includes(a)},attrs:{type:"button","data-prompt":e.prompt,"data-index":a,"data-responseBox":t.comboID(t.id,i,"responseBox"),"data-responseBoxGraph":t.comboID(t.id,i,"responseBox","graph"),"data-responseBoxTeamGraph":t.comboID(t.id,i,"responseBoxTeam","graph"),"data-responseBoxClassGraph":t.comboID(t.id,i,"responseBoxClass","graph"),"data-responseBoxTeam":t.comboID(t.id,i,"responseBoxTeam"),"data-responseBoxClass":t.comboID(t.id,i,"responseBoxClass"),"data-useGraphView":t.polling},on:{click:function(s){return t.setMultiChoiceResponse(i,a,e,o)}}},[t._v("\n                                "+t._s(o.replace(/<br\/>/g,t.brTag).replace(/\&/g," and "))+"\n                            ")])})),0):"unofficialView"!==t.currentMode||t.polling?"classView"===t.currentMode&&t.polling?s("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{id:t.comboID(t.id,i,"responseBoxClass","graph")}},t._l(e.responses,(function(e,o){return s("div",{key:o,staticClass:"classView dataEntryMultiChoiceResponse",attrs:{"data-index":o}},[s("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[s("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[s("span",[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),s("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,i,"responseBoxClass","graph"),o)}})])]),t._v(" "),s("span",{staticClass:"dataEntryMultiChoiceResponseCount"},[t._v(t._s(t.pollCounts[t.comboID(t.id,i,"responseBoxClass","graph")]&&t.pollCounts[t.comboID(t.id,i,"responseBoxClass","graph")][o]?t.pollCounts[t.comboID(t.id,i,"responseBoxClass","graph")][o]:0))])])])})),0):"unofficialView"===t.currentMode&&t.polling?s("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{id:t.comboID(t.id,i,"responseBox","graph")}},t._l(e.responses,(function(e,o){return s("div",{key:o,staticClass:"unofficialView dataEntryMultiChoiceResponse",attrs:{"data-index":o}},[s("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[s("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[s("span",[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),s("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,i,"responseBox","graph"),o)}})])]),t._v(" "),s("span",{staticClass:"dataEntryMultiChoiceResponseCount"},[t._v(t._s(t.pollCounts[t.comboID(t.id,i,"responseBox","graph")]&&t.pollCounts[t.comboID(t.id,i,"responseBox","graph")][o]?t.pollCounts[t.comboID(t.id,i,"responseBox","graph")][o]:0))])])])})),0):"teamView"===t.currentMode&&t.polling?s("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{id:t.comboID(t.id,i,"responseBoxTeam","graph")}},t._l(e.responses,(function(e,o){return s("div",{key:o,staticClass:"teamView dataEntryMultiChoiceResponse",attrs:{"data-index":o}},[s("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[s("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[s("span",[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),s("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[s("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,i,"responseBoxTeam","graph"),o)}})])]),t._v(" "),s("span",{staticClass:"dataEntryMultiChoiceResponseCount"},[t._v(t._s(t.pollCounts[t.comboID(t.id,i,"responseBoxTeam","graph")]&&t.pollCounts[t.comboID(t.id,i,"responseBoxTeam","graph")][o]?t.pollCounts[t.comboID(t.id,i,"responseBoxTeam","graph")][o]:0))])])])})),0):"teamView"!==t.currentMode||t.polling?"classView"!==t.currentMode||t.polling?t._e():s("div",{staticClass:"textResponses classView",attrs:{id:t.comboID(t.id,i,"responseBoxClass")}}):s("div",{staticClass:"textResponses teamView",attrs:{id:t.comboID(t.id,i,"responseBoxTeam")}}):s("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{id:t.comboID(t.id,i,"responseBox")}})]):t._e()]}))],2),t._v(" "),s("div",{staticClass:"dataEntryHeader"},["viewOnly"!==t.displayMode?s("div",{staticClass:"dataEntryEditModeButton",class:{active:"edit"===t.currentMode},on:{click:function(e){return t.editMode()}}},[s("span",[t._v(t._s(t.editModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.privateView?s("div",{staticClass:"dataEntryPrivateViewModeButton",class:{active:"privateView"===t.currentMode},on:{click:function(e){return t.privateViewMode()}}},[s("span",[t._v(t._s(t.privateViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.teamView?s("div",{staticClass:"dataEntryTeamViewModeButton",class:{active:"teamView"===t.currentMode},on:{click:function(e){return t.teamViewMode()}}},[s("span",[t._v(t._s(t.teamViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.classView?s("div",{staticClass:"dataEntryClassViewModeButton",class:{active:"classView"===t.currentMode},on:{click:function(e){return t.classViewMode()}}},[s("span",[t._v(t._s(t.classViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.view?s("div",{staticClass:"dataEntryViewModeButton",class:{active:"unofficialView"===t.currentMode},on:{click:function(e){return t.viewMode()}}},[s("span",[t._v(t._s(t.viewModeButtonText))])]):t._e(),t._v(" "),"true"===t.closeable?s("div",{staticClass:"dataEntryCloseButton",on:{click:function(t){return this.$destroy()}}},[s("i",{staticClass:"fa fa-times"})]):t._e()]),t._v(" "),"edit"===t.currentMode?s("div",{staticClass:"dataEntryFooter"},[t.enabledFooterButtons.formSubmit?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmit()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitPrivate?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitPrivate()}}},[t._v(t._s(t.formSubmitPrivateButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitTeam?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitTeam()}}},[t._v(t._s(t.formSubmitTeamButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitClass?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitClass()}}},[t._v(t._s(t.formSubmitClassButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitEmail?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitEmail()}}},[t._v(t._s(t.formSubmitEmailButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons["formSubmitTeam+All"]?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitTeamAll()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons["formSubmitClass+All"]?s("button",{staticClass:"dataEntryFormSubmit",on:{click:function(e){return t.formSubmitClassAll()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e()]):t._e()])])}),[],!1,null,null,null).exports;s.d(e,"insertExtensions",(function(){return p})),s.d(e,"createDataEntry",(function(){return c}));var n=window.parent&&window.parent.PeBL?window.parent.PeBL:window.PeBL?window.PeBL:null,r=window.parent.READIUM,l=window.parent.Configuration,d=window.parent.Lightbox;function p(){jQuery('.dataEntryExtension, .peblExtension[data-peblextension="dataentry"], .peblExtension[data-peblExtension="dataentry"], .peblExtension[data-peblExtension="dataentrypoll"], .peblExtension[data-peblextension="dataentrypoll"], .peblExtension[data-peblExtension="dataentrytext"], .peblExtension[data-peblextension="dataentrytext"], .peblExtension[data-peblExtension="dataentryfile"], .peblExtension[data-peblextension="dataentryfile"]').each((function(){var t=this.getAttribute("data-prompt"),e=this.getAttribute("data-id"),s=this.getAttribute("id"),i=JSON.parse(this.getAttribute("data-forms")),o=this.getAttribute("data-sharing"),a=this.getAttribute("data-displayMode")||jQuery(this)[0].getAttribute("data-displaymode"),n=this.hasAttribute("data-polling")?jQuery(this)[0].getAttribute("data-polling"):"false",r=this.hasAttribute("data-multiselectpolling")?this.getAttribute("data-multiselectpolling"):"1",l=this.hasAttribute("data-useConfig")?jQuery(this)[0].getAttribute("data-useConfig"):"false",d=this.hasAttribute("data-closeable")?this.getAttribute("data-closeable"):"false",p=this.hasAttribute("data-propertiesobject")?this.getAttribute("data-propertiesobject"):void 0;c('[id="'+s+'"]',s,t,e,i,o,a,n,parseInt(r),l,d,p)}))}function c(t,e,s,i,p,c,u,h,m,f,b,g){new o.a({el:t,render:t=>t(a,{props:{globalPebl:n,globalReadium:r,globalConfiguration:l,globalLightbox:d,insertID:e,prompt:s,id:i,forms:p,sharing:c,displayMode:u,polling:h,multiSelectPolling:m,useConfig:f,closeable:b,propertiesObject:g}})})}jQuery(document).ready((function(){window.parent.PeBLConfig&&window.parent.PeBLConfig.isAuthoring?document.addEventListener("pebleditorready",()=>{p()}):p()}))},function(t,e,s){"use strict";function i(t,e){for(var s=[],i={},o=0;o<e.length;o++){var a=e[o],n=a[0],r={id:t+":"+o,css:a[1],media:a[2],sourceMap:a[3]};i[n]?i[n].parts.push(r):s.push(i[n]={id:n,parts:[r]})}return s}s.r(e),s.d(e,"default",(function(){return h}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},n=o&&(document.head||document.getElementsByTagName("head")[0]),r=null,l=0,d=!1,p=function(){},c=null,u="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,s,o){d=s,c=o||{};var n=i(t,e);return m(n),function(e){for(var s=[],o=0;o<n.length;o++){var r=n[o];(l=a[r.id]).refs--,s.push(l)}e?m(n=i(t,e)):n=[];for(o=0;o<s.length;o++){var l;if(0===(l=s[o]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete a[l.id]}}}}function m(t){for(var e=0;e<t.length;e++){var s=t[e],i=a[s.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](s.parts[o]);for(;o<s.parts.length;o++)i.parts.push(b(s.parts[o]));i.parts.length>s.parts.length&&(i.parts.length=s.parts.length)}else{var n=[];for(o=0;o<s.parts.length;o++)n.push(b(s.parts[o]));a[s.id]={id:s.id,refs:1,parts:n}}}}function f(){var t=document.createElement("style");return t.type="text/css",n.appendChild(t),t}function b(t){var e,s,i=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(i){if(d)return p;i.parentNode.removeChild(i)}if(u){var o=l++;i=r||(r=f()),e=x.bind(null,i,o,!1),s=x.bind(null,i,o,!0)}else i=f(),e=y.bind(null,i),s=function(){i.parentNode.removeChild(i)};return e(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;e(t=i)}else s()}}var g,v=(g=[],function(t,e){return g[t]=e,g.filter(Boolean).join("\n")});function x(t,e,s,i){var o=s?"":i.css;if(t.styleSheet)t.styleSheet.cssText=v(e,o);else{var a=document.createTextNode(o),n=t.childNodes;n[e]&&t.removeChild(n[e]),n.length?t.insertBefore(a,n[e]):t.appendChild(a)}}function y(t,e){var s=e.css,i=e.media,o=e.sourceMap;if(i&&t.setAttribute("media",i),c.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),o&&(s+="\n/*# sourceURL="+o.sources[0]+" */",s+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}}]);