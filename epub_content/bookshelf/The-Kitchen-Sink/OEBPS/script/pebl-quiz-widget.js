var globalPebl="object"==typeof globalPebl?globalPebl:{};globalPebl.extension=globalPebl.extension||{},globalPebl.extension.PeblQuizWidget=function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=4)}([function(e,t){e.exports=Vue},function(e,t,i){var s=i(2);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,i(5).default)("917b5598",s,!0,{})},function(e,t,i){(e.exports=i(3)(!1)).push([e.i,'.pebl__quiz{border-left:var(--secondary-color) solid var(--side-border-size);background-color:var(--background-lighter);padding:.5em .5em .5em 2em}.retryButton{margin-top:0.5em}.pebl__quiz.finished .pebl__quiz--choices{display:none}.pebl__quiz>li{font-family:var(--font-family-secondary);color:var(--dark-font);border-bottom:var(--background-darker) solid 1px;padding:.5em 0;display:list-item;break-inside:avoid-column;-webkit-column-break-inside:avoid;vertical-align:top;width:100%}.pebl__quiz .pebl__quiz--choices{font-family:var(--font-family-primary);margin:1em 1em 0 -1em;list-style-type:none;padding:0;font-weight:normal}.pebl__quiz .pebl__quiz--choices li{cursor:pointer;padding:.25em 1em;padding-left:2em;margin:.25em 0em;border-radius:var(--border-radius)}.pebl__quiz .pebl__quiz--choices li:before{content:"\\25A2";margin-left:-1.5em;display:block;float:left}.pebl__quiz .pebl__quiz--choices li:hover{background-color:var(--background-darker);color:var(--light-font);box-shadow:var(--boxshadow-2)}.pebl__quiz .pebl__quiz--choices.reveal li.pebl__quiz--correct{background-color:var(--success-color);color:var(--light-font)}.pebl__quiz .pebl__quiz--choices.reveal.secondary li.pebl__quiz--correct{background-color:var(--success-color) !important;color:var(--light-font)}.pebl__quiz .pebl__quiz--choices.reveal li.pebl__quiz--correct:before{content:"\\2714" !important}.pebl__quiz .pebl__quiz--choices li.pebl__quiz--wrong{background-color:var(--alert-color);color:var(--light-font)}.pebl__quiz .pebl__quiz--choices li.pebl__quiz--wrong:before{content:"\\2716" !important}.pebl__quiz .pebl__quiz--feedback{font-family:var(--font-family-primary);color:var(--primary-color-dark);font-style:italic;margin-top:var(--spacing-s)}.questionPromptContainer{position:relative}.questionNumberSpan{position:absolute;left:-25px}.quizScore{font-family:var(--font-family-primary);color:var(--primary-color-dark);font-weight:bold;font-style:italic}\n',""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",s=e[3];if(!s)return i;if(t&&"function"==typeof btoa){var r=(o=s,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),n=s.sources.map((function(e){return"/*# sourceURL="+s.sourceRoot+e+" */"}));return[i].concat(n).concat([r]).join("\n")}var o;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var s={},r=0;r<this.length;r++){var n=this[r][0];"number"==typeof n&&(s[n]=!0)}for(r=0;r<e.length;r++){var o=e[r];"number"==typeof o[0]&&s[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),t.push(o))}},t}},function(e,t,i){"use strict";i.r(t),i.d(t,"insertExtensions",(function(){return c})),i.d(t,"createQuiz",(function(){return d}));i(1);var s=i(0),r=i.n(s);var n=function(e,t,i,s,r,n,o,a){var l=typeof(e=e||{}).default;"object"!==l&&"function"!==l||(e=e.default);var u,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=i,c._compiled=!0),s&&(c.functional=!0),n&&(c._scopeId=n),o?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=u):r&&(u=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),u)if(c.functional){c._injectStyles=u;var d=c.render;c.render=function(e,t){return u.call(t),d(e,t)}}else{var p=c.beforeCreate;c.beforeCreate=p?[].concat(p,u):[u]}return{exports:e,options:c}}(r.a.extend({name:"Widget",props:["globalPebl","globalReadium","globalConfiguration","globalLightbox","insertID","passMessage","failMessage","passingScore","questions","propertiesObject"],mounted(){let e=localStorage.getItem(this.insertID+"-quizAttempts");this.quizAttempts=e?JSON.parse(e):Array(this.questions.length).fill([]);let t=localStorage.getItem(this.insertID+"-quizFeedback");t&&(this.quizScoreText=t,this.quizFinished=!0,this.quizHide=!0),this.initQuiz()},computed:{},data:()=>({brTag:"<br/>",userProfile:null,quizAttempts:[],quizScoreText:"You haven't answered all of the questions yet!",quizFinished:!1,quizHide:!1,showFeedback:{},questionFeedback:{},failedQuestions:{},passedQuestions:{},wrongAnswers:{}}),methods:{retryQuiz:function(){localStorage.removeItem(this.insertID+"-quizFeedback"),localStorage.removeItem(this.insertID+"-quizAttempts"),this.quizFinished=!1,this.quizHide=!1,this.quizScoreText="You haven't answered all of the questions yet!",this.quizAttempts=Array(this.questions.length).fill([]),this.initQuiz()},selectAnswer:function(e,t,i,s,r){this.globalPebl.user.isLoggedIn(e=>{let n=JSON.parse(JSON.stringify(this.quizAttempts));if(e){if(0===this.quizAttempts[i].length){let e=s.answerText===t.correctAnswer;e?(n[i].push(!0),this.$set(this.questionFeedback,i,s.feedbackText?s.feedbackText:"Correct"),this.passedQuestions[i]=!0):(n[i].push(!1),this.$set(this.questionFeedback,i,s.feedbackText?s.feedbackText+" Try again.":"Not quite. Try again."),this.$set(this.wrongAnswers[i],r,!0)),this.$set(this.showFeedback,i,!0),this.globalPebl.emitEvent(this.globalPebl.events.eventAttempted,{prompt:t.prompt,answers:t.answers.map(e=>e.answerText),correctAnswers:[[t.correctAnswer]],answered:s.answerText,score:e?1:0,minScore:0,maxScore:1,complete:!0,success:e,activityType:"quiz",activityId:this.insertID}),this.quizAttempts=n,this.gradeQuiz(),this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()}else if(1===this.quizAttempts[i].length&&!1===this.quizAttempts[i][0]){let e=s.answerText===t.correctAnswer;e?(n[i].push(!0),this.$set(this.questionFeedback,i,s.feedbackText?s.feedbackText:"Correct"),this.passedQuestions[i]=!0):(n[i].push(!1),this.$set(this.questionFeedback,i,s.feedbackText?s.feedbackText:"Incorrect."),this.failedQuestions[i]=!0,this.$set(this.wrongAnswers[i],r,!0)),this.$set(this.showFeedback,i,!0),this.globalPebl.emitEvent(this.globalPebl.events.eventAttempted,{prompt:t.prompt,answers:t.answers.map(e=>e.answerText),correctAnswers:[[t.correctAnswer]],answered:s.answerText,score:e?1:0,minScore:0,maxScore:1,complete:!0,success:e,activityType:"quiz",activityId:this.insertID}),this.quizAttempts=n,this.gradeQuiz(),this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()}localStorage.setItem(this.insertID+"-quizAttempts",JSON.stringify(this.quizAttempts))}else this.globalLightbox.createLoginForm()})},failedQuestion:function(e){return!(!this.quizAttempts||!1!==this.quizAttempts[e][0]||!1!==this.quizAttempts[e][1])},passedQuestion:function(e){return!!(this.quizAttempts&&!0===this.quizAttempts[e][0]||!0===this.quizAttempts[e][1])},initQuiz:function(){for(let e=0;e<this.questions.length;e++)this.$set(this.showFeedback,e,!1),this.$set(this.questionFeedback,e,""),this.$set(this.failedQuestions,e,!1),this.$set(this.passedQuestions,e,!1),this.$set(this.wrongAnswers,e,{}),this.failedQuestion(e)?this.$set(this.failedQuestions,e,!0):this.passedQuestion(e)&&this.$set(this.passedQuestions,e,!0)},gradeQuiz:function(){let e=0,t=0,i=!0;for(var s=0;s<this.quizAttempts.length&&i;s++){var r=this.quizAttempts[s];(0==r.length||1==r.length&&!r[0])&&(i=!1),i&&(2==r.length&&r[1]||r[0])&&(e+=1),t+=1}if(i){let i,s,r=parseInt(this.passingScore)/100,n=(Math.round(e/t*100)/100*100|0)+"%";e/t>=r?(i=this.globalPebl.events.eventPassed,s=!0,this.passMessage?n+=" - "+this.passMessage:n+=" - You passed!"):(i=this.globalPebl.events.eventFailed,s=!1,this.failMessage?n+=" - "+this.failMessage:n+=" - You did not pass, you should review the material and try again."),this.globalPebl.emitEvent(i,{score:e,minScore:0,maxScore:t,complete:!0,success:s,activityId:this.insertID,activityType:"quiz"}),localStorage.setItem(this.insertID+"-quizFeedback",n),this.quizScoreText=n,this.quizFinished=!0}}}}),(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{"data-theme-target":e.insertID,contenteditable:"false","data-propertiesobject":e.propertiesObject}},[i("ol",{staticClass:"pebl__quiz",class:{finished:e.quizHide}},[e._l(e.questions,(function(t,s){return i("li",{key:t},[i("div",{staticClass:"questionPromptContainer"},[i("span",{domProps:{innerHTML:e._s(t.prompt)}})]),e._v(" "),i("ul",{staticClass:"pebl__quiz--choices",class:{reveal:e.passedQuestions[s]}},e._l(t.answers,(function(r,n){return i("li",{key:r,class:{"pebl__quiz--correct":r.answerText===t.correctAnswer,"pebl__quiz--wrong":e.wrongAnswers[s]&&e.wrongAnswers[s][n]},on:{click:function(i){return e.selectAnswer(i,t,s,r,n)}}},[e._v(e._s(r.answerText.replace(/<br\/>/g,e.brTag).replace(/&/g," and ")))])})),0),e._v(" "),e.showFeedback[s]?i("div",{staticClass:"pebl__quiz--feedback"},[e._v(e._s(e.questionFeedback[s].replace(/<br\/>/g,e.brTag).replace(/&/g," and ")))]):e._e()])})),e._v(" "),i("h3",{staticClass:"quizScore"},[e._v(e._s(e.quizScoreText.replace(/<br\/>/g,e.brTag).replace(/&/g," and ")))]),e._v(" "),e.quizFinished?i("button",{staticClass:"retryButton",on:{click:e.retryQuiz}},[e._v("Retry Quiz")]):e._e()],2)])}),[],!1,null,null,null).exports,o=window.parent&&window.parent.PeBL?window.parent.PeBL:window.PeBL?window.PeBL:null,a=window.parent.READIUM,l=window.parent.Configuration,u=window.parent.Lightbox;function c(){jQuery('.quiz_quizExtension, .peblExtension[data-peblextension="quiz"], .peblExtension[data-peblExtension="quiz"]').each((function(){var e=this.getAttribute("id");d('[id="'+e+'"]',e,this.hasAttribute("data-passingMessage")?this.getAttribute("data-passingMessage"):"",this.hasAttribute("data-failureMessage")?this.getAttribute("data-failureMessage"):"",this.hasAttribute("data-passingScore")?this.getAttribute("data-passingScore"):"80",JSON.parse(this.getAttribute("data-questions")),this.hasAttribute("data-propertiesobject")?this.getAttribute("data-propertiesobject"):void 0)}))}function d(e,t,i,s,c,d,p){new r.a({el:e,render:e=>e(n,{props:{globalPebl:o,globalReadium:a,globalConfiguration:l,globalLightbox:u,insertID:t,passMessage:i,failMessage:s,passingScore:c,questions:d,propertiesObject:p}})})}jQuery(document).ready(()=>{window.parent.PeBLConfig&&window.parent.PeBLConfig.isAuthoring?document.addEventListener("pebleditorready",()=>{c()}):c()})},function(e,t,i){"use strict";function s(e,t){for(var i=[],s={},r=0;r<t.length;r++){var n=t[r],o=n[0],a={id:e+":"+r,css:n[1],media:n[2],sourceMap:n[3]};s[o]?s[o].parts.push(a):i.push(s[o]={id:o,parts:[a]})}return i}i.r(t),i.d(t,"default",(function(){return h}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},o=r&&(document.head||document.getElementsByTagName("head")[0]),a=null,l=0,u=!1,c=function(){},d=null,p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(e,t,i,r){u=i,d=r||{};var o=s(e,t);return f(o),function(t){for(var i=[],r=0;r<o.length;r++){var a=o[r];(l=n[a.id]).refs--,i.push(l)}t?f(o=s(e,t)):o=[];for(r=0;r<i.length;r++){var l;if(0===(l=i[r]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete n[l.id]}}}}function f(e){for(var t=0;t<e.length;t++){var i=e[t],s=n[i.id];if(s){s.refs++;for(var r=0;r<s.parts.length;r++)s.parts[r](i.parts[r]);for(;r<i.parts.length;r++)s.parts.push(g(i.parts[r]));s.parts.length>i.parts.length&&(s.parts.length=i.parts.length)}else{var o=[];for(r=0;r<i.parts.length;r++)o.push(g(i.parts[r]));n[i.id]={id:i.id,refs:1,parts:o}}}}function b(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function g(e){var t,i,s=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(s){if(u)return c;s.parentNode.removeChild(s)}if(p){var r=l++;s=a||(a=b()),t=_.bind(null,s,r,!1),i=_.bind(null,s,r,!0)}else s=b(),t=q.bind(null,s),i=function(){s.parentNode.removeChild(s)};return t(e),function(s){if(s){if(s.css===e.css&&s.media===e.media&&s.sourceMap===e.sourceMap)return;t(e=s)}else i()}}var m,v=(m=[],function(e,t){return m[e]=t,m.filter(Boolean).join("\n")});function _(e,t,i,s){var r=i?"":s.css;if(e.styleSheet)e.styleSheet.cssText=v(t,r);else{var n=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(n,o[t]):e.appendChild(n)}}function q(e,t){var i=t.css,s=t.media,r=t.sourceMap;if(s&&e.setAttribute("media",s),d.ssrId&&e.setAttribute("data-vue-ssr-id",t.id),r&&(i+="\n/*# sourceURL="+r.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}}]);