var globalPebl="object"==typeof globalPebl?globalPebl:{};globalPebl.extension=globalPebl.extension||{},globalPebl.extension.PeblDataEntryWidget=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=4)}([function(t,e){t.exports=Vue},function(t,e,i){var s=i(2);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);(0,i(5).default)("917b5598",s,!0,{})},function(t,e,i){(t.exports=i(3)(!1)).push([t.i,'.dataEntryWrapper{break-inside:avoid-column;padding:1rem 0rem;-webkit-column-break-inside:avoid}.dataEntryCfiPlaceholder{margin:0 !important;padding:0 !important;color:transparent !important;font-size:1px !important;line-height:0 !important}.dataEntryCallout,.dataEntrySubFormCallout{background-color:var(--background-lighter);width:calc(100% - 2px);margin:0;clear:both;overflow:hidden;break-inside:avoid-column;-webkit-column-break-inside:avoid;display:flex;flex-direction:column;-webkit-transform:translateX(0)}.dataEntryCallout.edit input[type=radio]{display:inline-block}.dataEntryCallout input[type=radio]{-webkit-appearance:none;-moz-appearance:none;appearance:none;position:relative;border:2px solid var(--secondary-color-dark);background-color:transparent;color:var(--light-font);height:2em;width:2em;border-radius:1000px;cursor:pointer;outline:none;margin-right:7px;transition:all var(--transition-fast)}.dataEntryCallout input[type=radio]:hover{background-color:var(--secondary-color-dark)}.dataEntryCallout input[type=radio]:checked{background-color:var(--secondary-color-dark)}.dataEntryCallout input[type=radio]:checked::before{content:"\\2143";position:absolute;font:1em/1 "Open Sans",sans-serif;left:8px;top:5px;transform:rotate(40deg)}.dataEntryTableContainer table input[type=radio]{left:0;right:0;margin-left:auto;margin-right:auto}.dataEntryCallout::after{content:" ";display:block;height:0;clear:both}.dataEntryCallout p{font-weight:600;font-size:1.1em;font-family:var(--font-family-secondary);margin:0;padding:0}.dataEntryHeader{font-size:.9em;display:flex;justify-content:space-around;align-items:center;color:var(--dark-font);order:1}.dataEntryHeader>div{width:100%;background:var(--background-light);text-align:center;padding:var(--spacing-xs);cursor:pointer}.dataEntryHeader>div:hover{background:var(--secondary-color-dark) !important;color:var(--light-font)}.dataEntryHeader>div.active{color:var(--light-font);background:var(--secondary-color-light)}.dataEntryFooter>button:hover{background:var(--primary-color-dark)}.dataEntryCallout form{max-height:calc(70vh - 192px);overflow:auto;order:2;min-height:80px}.dataEntryCallout form.fixScrolling,.dataEntrySubFormCallout form.fixScrolling{will-change:transform}.dataEntryCallout form>.textBox,.dataEntryCallout form>.dataEntryTableContainer,.dataEntrySubFormCallout form>.textBox,.dataEntryCallout form>.dataEntryHeaderEntry,.dataEntryCallout form>.dataEntryCheckboxContainer{padding:0 var(--spacing);margin-bottom:var(--spacing)}.dataEntryCallout form>p,.dataEntrySubFormCallout form>p{padding:1em}.dataEntryFooter{border-top:1px solid var(--background-darker);display:flex;align-items:center;justify-content:space-around;width:100%;min-height:10px;margin-top:var(--spacing-s);padding:var(--spacing-s);order:3}.dataEntryFooter>button{width:100%;color:#fff;background:var(--primary-color);padding:.5em 0em;margin:.5em;border:none;font-size:.9em;cursor:pointer}.textInput label,.dataEntryFileInputEditContainer label{display:block;margin:1em 0 0 0;font-weight:400;font-size:.9rem;font-family:var(--font-family-secondary)}.textResponses{display:block;max-height:280px;box-sizing:border-box;padding:0;margin-top:1em;margin-left:-1em;margin-right:-1em;overflow:auto;-webkit-overflow-scrolling:touch;font-family:var(--font-family-secondary);font-style:normal;font-weight:normal;font-size:14px;border-top:1px solid #ddd;border-bottom:1px solid #ddd;clear:both}.dataEntryTextResponseNoData{margin-top:1em !important;margin-left:2em !important;margin-bottom:1em !important}.textResponses>.response:not([style*="display: none"])~.dataEntryTextResponseNoData{display:none}.textResponses .response,.dataEntryCheckboxContainer .response{position:relative;padding:.8em 1em .5em 3em;margin:0;background:#eee;border-bottom:1px solid #ddd}.textResponses .response>i,.dataEntryCheckboxContainer .response>i{position:absolute;left:.5em;font-size:1.5em}.textResponses .showMore{display:block;padding:1em;padding-left:80px;margin:0;font-style:italic}.textResponses .your.response,.dataEntryCheckboxContainer .your.response{background-color:var(--background-light)}.textResponses .response .userId,.dataEntryCheckboxContainer .response .userId{font-weight:bold}.textResponses .response .timestamp,.dataEntryCheckboxContainer .response .timestamp{margin-left:.5em;font-size:.75em;color:#999}.textResponses .response .message,.dataEntryCheckboxContainer .response .message{font-style:normal;font-family:var(--font-family-secondary);font-weight:normal;margin:.5em 0}.dataEntryCheckboxContainer{display:flex;align-items:center;justify-content:space-between}.dataEntryCheckboxContainer>span{padding:.5em;width:100%}.dataEntryCheckboxContainer>input[type=checkbox]{will-change:transform;-ms-transform:scale(1.5);-moz-transform:scale(1.5);-webkit-transform:scale(1.5);-o-transform:scale(1.5);transform:scale(1.5);padding:10px;margin:1em}.dataEntryCheckboxResponseContainer{padding:.5em;max-width:50%;font-family:var(--font-family-secondary);font-style:normal;font-weight:normal;font-size:14px;flex-shrink:0}.dataEntryCheckboxResponseContainer>span{display:block}.dataEntryDropdownContainer{padding-left:1em;padding-right:1em;margin-bottom:1em}.dataEntryDropdownContainer select{max-width:90%;margin-left:1em}.dataEntryDropdownContainer .textResponses{margin-top:2em}.dataEntrySubFormCallout{display:none;position:fixed;background-color:var(--background-light);top:60px;left:0;max-height:calc(100% - 70px);overflow:auto}.dataEntryMultiChoiceContainer{padding-left:1em;padding-right:1em}.dataEntryMultiChoiceButtonsContainer{display:flex;flex-direction:column;font-family:var(--font-family-secondary)}.dataEntryMultiChoiceButton{margin:1px 0;padding:1em;text-align:left;background:var(--background-darker)}.dataEntryMultiChoiceButton.active{background:var(--secondary-color-light);color:var(--light-font)}.dataEntryMultiChoiceButton:hover{background:var(--secondary-color);color:#fff}.dataEntryMultiChoiceResponse{margin:.5em}.dataEntryMultiChoiceResponseContent{display:flex}.dataEntryMultiChoiceResponseTextContainer{width:50%}.dataEntryMultiChoiceResponseGraphContainer{width:50%;padding-left:1em;box-sizing:border-box}.dataEntryMultiChoiceResponseGraphParentBar{background:rgba(0,0,0,.1);width:100%;height:1em;position:relative;border-radius:1000px}.dataEntryMultiChoiceResponseGraphFillBar{background:var(--secondary-color);height:100%;width:0;float:right;border-radius:1000px;transition:width .5s ease}.dataEntryMultiChoiceResponseCount{margin-left:1em}.pollingWindow{background:var(--background-light);position:fixed;top:0;left:0;right:0;margin:1em;z-index:9999;display:flex;justify-content:center;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23)}.pollingWindow>.dataEntryCallout{width:100% !important;font-family:var(--font-family-secondary)}.pollingWindow form>p{font-weight:bold;font-size:1.2em;font-family:var(--font-family-secondary)}.pollingWindow .dataEntryMultiChoiceButton{font-size:1em;font-weight:bold;padding:1em}.pollingWindow .dataEntryFormSubmit{font-weight:bold;font-size:1.2em}.pollingWindow .dataEntryCallout{max-height:calc(100vh - 105px)}.pollingWindow .dataEntryCallout form{max-height:calc(100vh - 192px)}.showInlineMakeOfficial .inlineMakeOfficialContainer{display:flex;align-items:center}.inlineMakeOfficialContainer{display:none;color:var(--primary-color)}.dataEntryTableContainer table th{font-weight:500;font-family:var(--font-family-secondary);font-size:.9em;color:var(--background-darker);text-align:center;padding:.5em}.dataEntryTableContainer table td{background:transparent;text-align:center;padding:.5em}.dataEntryFileInputContainer{padding:1em}.dataEntryFileInputQueuedResponses{display:flex;flex-direction:column;margin-top:1em}.dataEntryFileInputResponse{display:flex;align-items:center;margin-bottom:1em}.dataEntryFileInputResponseIcon{color:var(--primary-color-light)}.dataEntryFileInputResponseDeleteIcon{color:#575757;cursor:pointer}.dataEntryFileInputDownloadIcon{color:#575757;cursor:pointer}.dataEntryFileInputResponseTextContainer{display:flex;flex-direction:column;width:100%;overflow:hidden;padding-left:1em;padding-right:1em}.dataEntryFileInputResponseTextContainerMedia{display:flex;width:100%;overflow:hidden;justify-content:space-between}.dataEntryFileInputResponseText{font-weight:bold;overflow:hidden;text-overflow:ellipsis}.dataEntryFileInputDropZone{border:dashed 2px gray;border-radius:5px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1em;margin-bottom:1em}.dataEntryFileInputDropZone i{margin-bottom:.5em;color:gray}.dataEntryFileInputDropZone.dragging{opacity:.5}.dataEntryFileInputDropZoneLink{text-decoration:unerline;text-decoration-color:var(--primary-color);color:var(--primary-color);cursor:pointer}.dataEntryFileInputDropZone input{position:absolute;left:-1000px}.dataEntryFileInputImagePreview{width:100%}.dataEntryFileInputVideoPreview{width:100%}.dataEntryFileInputPreviewContainer{margin-top:1em}.dataEntryClickableSpan{color:var(--primary-color);text-decoration-color:var(--primary-color);text-decoration:underline;cursor:pointer}',""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",s=t[3];if(!s)return i;if(e&&"function"==typeof btoa){var o=(n=s,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),a=s.sources.map((function(t){return"/*# sourceURL="+s.sourceRoot+t+" */"}));return[i].concat(a).concat([o]).join("\n")}var n;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i})).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var s={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(s[a]=!0)}for(o=0;o<t.length;o++){var n=t[o];"number"==typeof n[0]&&s[n[0]]||(i&&!n[2]?n[2]=i:i&&(n[2]="("+n[2]+") and ("+i+")"),e.push(n))}},e}},function(t,e,i){"use strict";i.r(e);i(1);var s=i(0),o=i.n(s);var a=function(t,e,i,s,o,a,n,r){var l=typeof(t=t||{}).default;"object"!==l&&"function"!==l||(t=t.default);var d,p="function"==typeof t?t.options:t;if(e&&(p.render=e,p.staticRenderFns=i,p._compiled=!0),s&&(p.functional=!0),a&&(p._scopeId=a),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},p._ssrRegister=d):o&&(d=r?function(){o.call(this,this.$root.$options.shadowRoot)}:o),d)if(p.functional){p._injectStyles=d;var u=p.render;p.render=function(t,e){return d.call(e),u(t,e)}}else{var c=p.beforeCreate;p.beforeCreate=c?[].concat(c,d):[d]}return{exports:t,options:p}}(o.a.extend({name:"Widget",props:["globalPebl","globalReadium","globalConfiguration","globalLightbox","insertID","prompt","id","forms","sharing","displayMode","polling","multiSelectPolling","useConfig","closeable","propertiesObject","authoringId"],created(){for(let t=0;t<this.forms.length;t++){let e=this.forms[t];"text"===e.type?this.initTextEntry(this.comboID(this.id,t.toString()),e.prompt):"file"===e.type&&this.initFileEntry(this.comboID(this.id,t.toString()),e.prompt)}},mounted(){if(this.globalPebl&&this.globalPebl.extension.config&&this.globalPebl.extension.config.dataEntry){let t=this.globalPebl.extension.config.dataEntry;t.formSubmitButtonText&&(this.formSubmitButtonText=t.formSubmitButtonText),t.formSubmitTeamButtonText&&(this.formSubmitTeamButtonText=t.formSubmitTeamButtonText),t.formSubmitClassButtonText&&(this.formSubmitClassButtonText=t.formSubmitClassButtonText),t.viewModeButtonText&&(this.viewModeButtonText=t.viewModeButtonText),t.teamViewModeButtonText&&(this.teamViewModeButtonText=t.teamViewModeButtonText),t.classViewModeButtonText&&(this.classViewModeButtonText=t.classViewModeButtonText),t.teamViewResponsesText&&(this.modeTextMap.viewPara.teamView=t.teamViewResponsesText),t.classViewResponsesText&&(this.modeTextMap.viewPara.classView=t.classViewResponsesText)}let t=this.sharing;this.globalPebl.user.getUser(e=>{this.userProfile=e;let i=this.dataMessageHandler(this.id);"private"===this.sharing?(e&&this.globalPebl.subscribeThread(this.id,!1,i,{isPrivate:!0}),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledFooterButtons,"formSubmitPrivate",!0)):"private+email"===this.sharing?(e&&this.globalPebl.subscribeThread(this.id,!1,i,{isPrivate:!0}),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledFooterButtons,"formSubmitEmail",!0)):"private+all"===this.sharing?(e&&(this.globalPebl.subscribeThread(this.id,!1,i),this.globalPebl.subscribeThread(this.id,!1,i,{isPrivate:!0})),this.$set(this.enabledHeaderButtons,"privateView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitPrivate",!0),this.$set(this.enabledFooterButtons,"formSubmit",!0)):"team+class"===this.sharing?e&&!e.currentClass?t="team":e&&!e.currentTeam?t="class":(e&&(this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentTeam}),this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentClass})),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam",!0),this.$set(this.enabledFooterButtons,"formSubmitClass",!0)):"team+all"===this.sharing&&(e&&!e.currentTeam?t="class+all":(e&&(this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentTeam}),this.globalPebl.subscribeThread(this.id,!1,i)),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam+All",!0))),"class+all"===t&&(e&&!e.currentClass?t="all":(e&&(this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentClass}),this.globalPebl.subscribeThread(this.id,!1,i)),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmitClass+All",!0))),"team"===t&&(e&&!e.currentTeam?t="class":(e&&this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentTeam}),this.$set(this.enabledHeaderButtons,"teamView",!0),this.$set(this.enabledFooterButtons,"formSubmitTeam",!0))),"class"===t&&(e&&!e.currentClass?t="all":(e&&this.globalPebl.subscribeThread(this.id,!1,i,{groupId:e.currentClass}),this.$set(this.enabledHeaderButtons,"classView",!0),this.$set(this.enabledFooterButtons,"formSubmitClass",!0))),"all"===t&&(e&&this.globalPebl.subscribeThread(this.id,!1,i),this.$set(this.enabledHeaderButtons,"view",!0),this.$set(this.enabledFooterButtons,"formSubmit",!0)),"viewOnly"===this.displayMode&&("all"===t?this.viewMode():"team"===t?this.teamViewMode():"class"===t?this.classViewMode():"private"===t||"private+email"===t||"private+all"===t?this.privateViewMode():"team+class"===t||"team+all"===t?this.teamViewMode():"class+all"===t&&this.classViewMode())})},computed:{},data:()=>({userProfile:{},brTag:"<br/>",globalPebl:null,globalReadium:null,globalConfiguration:null,globalLightbox:null,insertID:"",prompt:"",id:"",forms:[],sharing:"",displayMode:"",polling:"",multiSelectPolling:1,useConfig:"",closeable:"",currentMode:"edit",invalidFormActive:!1,modeTextMap:{viewPara:{unofficialView:"View responses from other users below for this activity",teamView:"View your team‘s responses below for this activity.",classView:"View responses from the class below for this activity.",officialView:"View official responses below for this activity.",privateview:"View your private responses below for this activity."},textResponseNoData:{unoffialView:"Nothing has been submitted yet.",teamView:"Nothing has been submitted yet.",classView:"Nothing has been submitted yet.",officialView:"Nothing has been submitted yet.",privateView:"Nothing has been submitted yet."}},enabledHeaderButtons:{},enabledFooterButtons:{},editModeButtonText:"Participate",viewModeButtonText:"View Responses",classViewModeButtonText:"View Class Responses",teamViewModeButtonText:"View Team Responses",privateViewModeButtonText:"View Private Responses",formSubmitButtonText:"Share",formSubmitPrivateButtonText:"Submit Privately",formSubmitTeamButtonText:"Share with Team",formSubmitClassButtonText:"Share with Class",formSubmitEmailButtonText:"Email",activeMultiChoiceButton:{},pollCounts:{},messageModels:{},multiChoiceModels:{},fileUploadModels:{},messageResponses:{},multiChoiceResponses:{},fileResponses:{}}),methods:{initTextEntry:function(t,e){this.$set(this.messageModels,t,{mainPrompt:this.prompt,prompt:e,thread:t,text:"",type:"text"})},initFileEntry:function(t,e){this.$set(this.fileUploadModels,t,{mainPrompt:this.prompt,prompt:e,thread:t,text:[],files:[],type:"file"})},setFormType:function(t,e){this.$set(this.forms[t],"type",e),this.forms=JSON.parse(JSON.stringify(this.forms))},downloadFile:function(t){let e=document.createElement("a");e.setAttribute("style","display: none;"),e.href=t.objectUrl,e.download=t.name,document.body.appendChild(e),e.click(),document.body.removeChild(e)},fileIsImage:function(t){return t&&"image"===t.type.split("/")[0]},fileIsVideo:function(t){return t&&"video"===t.type.split("/")[0]},fileSize:function(t){var e=Math.floor(Math.log(t)/Math.log(1024));return 1*parseFloat((t/Math.pow(1024,e)).toFixed(2))+" "+["B","kB","MB","GB","TB"][e]},handleFileDrop:function(t,e,i){if(t.dataTransfer){let i=Array.from(t.dataTransfer.files),s=this.fileUploadModels[e].files.concat(i);this.$set(this.fileUploadModels[e],"files",s),this.$set(this.fileUploadModels[e],"text",s.map(t=>this.globalPebl.utils.getUuid()))}},updateFileModel:function(t,e,i){if(t.target&&t.target.files){let i=Array.from(t.target.files),s=this.fileUploadModels[e].files.concat(i);this.$set(this.fileUploadModels[e],"files",s),this.$set(this.fileUploadModels[e],"text",s.map(t=>this.globalPebl.utils.getUuid()))}},removeFileModel:function(t,e){this.fileUploadModels[e].files.splice(t,1),this.fileUploadModels[e].text.splice(t,1),this.$set(this.fileUploadModels,e,this.fileUploadModels[e])},getPollWidth:function(t,e){if(!this.pollCounts[t]||!this.pollCounts[t][e])return"0%";if(0===this.pollCounts[t][e])return"0%";if(!this.pollCounts[t].totalCount)return"0%";if(0===this.pollCounts[t].totalCount)return"0%";return(this.pollCounts[t][e]/this.pollCounts[t].totalCount*100).toString()+"%"},addScrollFix:function(){return!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)},setMultiChoiceResponse:function(t,e,i,s){if(this.multiSelectPolling){let o=!1;this.activeMultiChoiceButton[this.comboID(this.id,t.toString())]||this.$set(this.activeMultiChoiceButton,this.comboID(this.id,t.toString()),[]),this.multiChoiceModels[this.comboID(this.id,t.toString())]||this.$set(this.multiChoiceModels,this.comboID(this.id,t.toString()),{prompt:i.prompt,thread:this.comboID(this.id,t.toString()),useGraphView:this.polling,type:"multipleChoice",text:[],index:[]});for(let i=0;i<this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].length;i++)if(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())][i]===e){this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].splice(i,1),this.multiChoiceModels[this.comboID(this.id,t.toString())].text.splice(i,1),this.multiChoiceModels[this.comboID(this.id,t.toString())].index.splice(i,1),o=!0;break}!o&&this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].length<this.multiSelectPolling&&(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())].push(e),Array.isArray(this.multiChoiceModels[this.comboID(this.id,t.toString())].text)||(this.multiChoiceModels[this.comboID(this.id,t.toString())].text=[]),Array.isArray(this.multiChoiceModels[this.comboID(this.id,t.toString())].index)||(this.multiChoiceModels[this.comboID(this.id,t.toString())].index=[]),this.multiChoiceModels[this.comboID(this.id,t.toString())].text.push(s),this.multiChoiceModels[this.comboID(this.id,t.toString())].index.push(e))}else this.$set(this.multiChoiceModels,this.comboID(this.id,t.toString()),{prompt:i.prompt,thread:this.comboID(this.id,t.toString()),useGraphView:this.polling,type:"multipleChoice"}),this.$set(this.activeMultiChoiceButton,this.comboID(this.id,t.toString()),[e]),this.multiChoiceModels[this.comboID(this.id,t.toString())].text=s,this.multiChoiceModels[this.comboID(this.id,t.toString())].index=e;console.log(this.activeMultiChoiceButton[this.comboID(this.id,t.toString())])},comboID:function(...t){for(var e=null,i=0;i<arguments.length;i++){var s=arguments[i];e=null===e?s:e+"_"+s}return e},invalidForm:function(){this.invalidFormActive||(this.invalidFormActive=!0,window.alert("Please fill out the entire form"))},sortMessages:function(t,e){return new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()},dataMessageHandler:function(t){return t=>{this.globalPebl.user.getUser(e=>{if(e)for(let i of t){let t=JSON.parse(i.text);for(let s of t)s.timestamp=i.timestamp,s.id=this.comboID(i.id,s.thread),s.name=i.name,s.identity=i.actor.account.name,"text"===s.type?this.messageHandler(s,e):"file"===s.type?this.fileMessageHandler(s,e):"multipleChoice"===s.type&&("true"===s.useGraphView?this.multiSelectPolling?this.multiSelectPollingHandler(s,e):this.multiChoiceMessageHandler(s,e):this.messageHandler(s,e))}})}},getFileUrl:function(t){return(window.URL||window.webkitURL).createObjectURL(t)},fileMessageHandler:function(t,e){this.fileResponses[t.responseBox]||this.$set(this.fileResponses,t.responseBox,{});let i=this.fileResponses[t.responseBox][t.identity];if(i){if(new Date(t.timestamp)>new Date(i.timestamp)){let e=[];for(let i of t.text)e.push(this.globalPebl.storage.getAsset(i));Promise.all(e).then(e=>{e.map(t=>{Object.defineProperty(t,"objectUrl",{value:this.getFileUrl(t)})}),this.$set(this.fileResponses[t.responseBox],t.identity,t),this.$set(this.fileResponses[t.responseBox][t.identity],"files",e)})}}else{let e=[];for(let i of t.text)e.push(this.globalPebl.storage.getAsset(i));Promise.all(e).then(e=>{t.files=e.map(t=>{Object.defineProperty(t,"objectUrl",{value:this.getFileUrl(t)})}),this.$set(this.fileResponses[t.responseBox],t.identity,t),this.$set(this.fileResponses[t.responseBox][t.identity],"files",e)})}},messageHandler:function(t,e){t.mine=e.name===t.name,this.messageResponses[t.responseBox]||this.$set(this.messageResponses,t.responseBox,{});let i=this.messageResponses[t.responseBox][t.identity];i?new Date(t.timestamp)>new Date(i.timestamp)&&this.$set(this.messageResponses[t.responseBox],t.identity,t):this.$set(this.messageResponses[t.responseBox],t.identity,t)},multiSelectPollingHandler:function(t,e){this.multiChoiceResponses[t.responseBox]||this.$set(this.multiChoiceResponses,t.responseBox,{}),this.pollCounts[t.responseBox]||this.$set(this.pollCounts,t.responseBox,{totalCount:0});for(let e of t.index)this.pollCounts[t.responseBox][e]||this.$set(this.pollCounts[t.responseBox],e,0);let i=this.multiChoiceResponses[t.responseBox][t.identity];if(i){if(new Date(t.timestamp)>new Date(i.timestamp)){this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount-i.index.length),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+t.index.length);for(let e of i.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]-1);for(let e of t.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]+1)}}else{this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+t.index.length);for(let e of t.index)this.$set(this.pollCounts[t.responseBox],e,this.pollCounts[t.responseBox][e]+1)}},multiChoiceMessageHandler:function(t,e){this.multiChoiceResponses[t.responseBox]||this.$set(this.multiChoiceResponses,t.responseBox,{}),this.pollCounts[t.responseBox]||this.$set(this.pollCounts,t.responseBox,{totalCount:0}),this.pollCounts[t.responseBox][t.index]||this.$set(this.pollCounts[t.responseBox],t.index,0);let i=this.multiChoiceResponses[t.responseBox][t.identity];i?new Date(t.timestamp)>new Date(i.timestamp)&&(this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),i.index!==t.index&&(this.$set(this.pollCounts[t.responseBox],i.index,this.pollCounts[t.responseBox][i.index]-1),this.$set(this.pollCounts[t.responseBox],t.index,this.pollCounts[t.responseBox][t.index]+1))):(this.$set(this.multiChoiceResponses[t.responseBox],t.identity,t),this.$set(this.pollCounts[t.responseBox],"totalCount",this.pollCounts[t.responseBox].totalCount+1),this.$set(this.pollCounts[t.responseBox],t.index,this.pollCounts[t.responseBox][t.index]+1))},editMode:function(){this.currentMode="edit",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},viewMode:function(){this.currentMode="unofficialView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},privateViewMode:function(){this.currentMode="privateView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},teamViewMode:function(){this.currentMode="teamView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},classViewMode:function(){this.currentMode="classView",this.globalReadium&&null!=this.globalReadium.reader.plugins.highlights&&this.globalReadium.reader.plugins.highlights.redrawAnnotations()},getFormData:function(t){this.invalidFormActive=!1;let e=[];e=e.concat(Object.values(this.messageModels),Object.values(this.multiChoiceModels),Object.values(this.fileUploadModels));for(let i of e)if(i.responseBox=this.comboID(i.thread,t),"multipleChoice"===i.type&&"true"===this.polling)if(i.responseBox=this.comboID(i.responseBox,"graph"),this.multiSelectPolling)for(let t of i.text)this.globalPebl.emitEvent(this.globalPebl.events.eventPreferred,{activityType:"poll",activityId:this.id,name:i.prompt,description:t});else this.globalPebl.emitEvent(this.globalPebl.events.eventPreferred,{activityType:"poll",activityId:this.id,name:i.prompt,description:i.text});else if("file"===i.type)for(let t=0;t<i.files.length;t++)this.globalPebl.storage.saveAsset(i.text[t],i.files[t],()=>{this.globalPebl.emitEvent(this.globalPebl.events.eventUploadedMedia,{activityType:"data-entry",activityId:this.id,name:i.prompt,description:i.text[t],mediaId:i.text[t]})});return e},sendMessage:function(t,e,i,s){let o=this.getFormData(t);o.length>0&&this.globalPebl.storage.getCurrentBookTitle(t=>{let a={prompt:this.prompt,thread:this.id,text:JSON.stringify(o),additionalResultData:{subResponses:o.map(t=>({prompt:t.prompt,response:t.text}))},isPrivate:e,groupId:i,book:t,activityType:"true"===this.polling?"poll":"data-entry",activityId:this.id,cfi:void 0,idRef:void 0};if(this.globalReadium){let t=this.globalReadium.reader.bookmarkCurrentPage();t&&(t=JSON.parse(t),a.cfi=t.contentCFI,a.idRef=t.idref)}this.globalPebl&&this.globalPebl.emitEvent(this.globalPebl.events.newMessage,a),s(a)})},formSubmit:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBox",!1,void 0,()=>{this.viewMode()})})},formSubmitPrivate:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBoxPrivate",!0,void 0,()=>{this.privateViewMode()})})},formSubmitEmail:function(){let t=this.getFormData("responseBoxPrivate");if(t.length>0){let e={prompt:this.prompt,thread:this.id,text:JSON.stringify(t),additionalResultData:{subResponses:t.map(t=>({prompt:t.prompt,response:t.text}))},isPrivate:!0,book:this.globalPebl.extension.config.bookTitle},i="mailto:?subject="+encodeURI(e.book)+"&body=";i+=encodeURI(e.prompt+"\r\n\r\n");for(let t of e.additionalResultData.subResponses)i+=encodeURI(t.prompt+"\r\n"),i+=encodeURI(t.response+"\r\n\r\n");let s=document.createElement("form");s.setAttribute("style","display: none"),s.target="_blank",s.action=i,s.method="post",document.body.appendChild(s),s.submit(),document.body.removeChild(s)}this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.sendMessage("responseBoxPrivate",!0,void 0,t=>{this.privateViewMode()})})},formSubmitTeam:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxTeam",!1,t.currentTeam,()=>{this.teamViewMode()})})})},formSubmitClass:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxClass",!1,t.currentClass,()=>{this.classViewMode()})})})},formSubmitTeamAll:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxTeam",!1,t.currentTeam,()=>{this.sendMessage("responseBox",!1,void 0,()=>{this.teamViewMode()})})})})},formSubmitClassAll:function(){this.globalPebl.user.isLoggedIn(t=>{!t&&this.globalLightbox?this.globalLightbox.createLoginForm():this.globalPebl.user.getUser(t=>{this.sendMessage("responseBoxClass",!1,t.currentClass,()=>{this.sendMessage("responseBox",!1,void 0,()=>{this.classViewMode()})})})})}}}),(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dataEntryWrapper",attrs:{"data-theme-target":t.insertID,contenteditable:"false","data-authoringid":t.authoringId,"data-propertiesobject":t.propertiesObject}},[i("div",{staticClass:"dataEntryCallout"},[i("div",{staticClass:"dataEntryHeader"},["viewOnly"!==t.displayMode?i("div",{staticClass:"dataEntryEditModeButton",class:{active:"edit"===t.currentMode},attrs:{tabindex:"0"},on:{click:function(e){return t.editMode()}}},[i("span",[t._v(t._s(t.editModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.privateView?i("div",{staticClass:"dataEntryPrivateViewModeButton",class:{active:"privateView"===t.currentMode},attrs:{tabindex:"0"},on:{click:function(e){return t.privateViewMode()}}},[i("span",[t._v(t._s(t.privateViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.teamView?i("div",{staticClass:"dataEntryTeamViewModeButton",class:{active:"teamView"===t.currentMode},attrs:{tabindex:"0"},on:{click:function(e){return t.teamViewMode()}}},[i("span",[t._v(t._s(t.teamViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.classView?i("div",{staticClass:"dataEntryClassViewModeButton",class:{active:"classView"===t.currentMode},attrs:{tabindex:"0"},on:{click:function(e){return t.classViewMode()}}},[i("span",[t._v(t._s(t.classViewModeButtonText))])]):t._e(),t._v(" "),t.enabledHeaderButtons.view?i("div",{staticClass:"dataEntryViewModeButton",class:{active:"unofficialView"===t.currentMode},attrs:{tabindex:"0"},on:{click:function(e){return t.viewMode()}}},[i("span",[t._v(t._s(t.viewModeButtonText))])]):t._e(),t._v(" "),"true"===t.closeable?i("div",{staticClass:"dataEntryCloseButton",attrs:{tabindex:"0"},on:{click:function(t){return this.$destroy()}}},[i("i",{staticClass:"fa fa-times"})]):t._e()]),t._v(" "),i("form",{class:{fixScrolling:t.addScrollFix()}},[i("p",{staticClass:"dataEntryMainPrompt",style:{"display: none;":!t.prompt||0===t.prompt.length}},[t._v(t._s(t.prompt?t.prompt.replace(/\&/g," and "):""))]),t._v(" "),t.modeTextMap.viewPara[t.currentMode]?i("p",{class:t.currentMode},[t._v(t._s(t.modeTextMap.viewPara[t.currentMode]))]):t._e(),t._v(" "),t._l(t.forms,(function(e,s){return["text"===e.type?i("div",{key:e,staticClass:"textBox"},[i("div",{staticClass:"textInput",class:e.cssClass},[i("label",[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.messageModels[t.comboID(t.id,s)].text,expression:"messageModels[comboID(id, index)].text"}],staticClass:"edit",attrs:{"aria-label":t.prompt+". "+e.prompt,required:!!e.required&&"required",oninvalid:t.invalidForm,placeholder:e.placeholder?e.placeholder.replace(/\&/g," and "):"",id:t.comboID(t.id,s)},domProps:{value:t.messageModels[t.comboID(t.id,s)].text},on:{input:function(e){e.target.composing||t.$set(t.messageModels[t.comboID(t.id,s)],"text",e.target.value)}}}):t._e(),t._v(" "),e.allowMediaUpload&&"edit"===t.currentMode?i("span",{staticClass:"dataEntryClickableSpan",on:{click:function(i){t.setFormType(s,"file"),t.initFileEntry(t.comboID(t.id,s.toString()),e.prompt)}}},[t._v("Upload File")]):t._e()]),t._v(" "),"unofficialView"===t.currentMode?i("div",{staticClass:"textResponses unofficialView",attrs:{"aria-live":"polite",role:"log",id:t.comboID(t.id,s,"responseBox")}},[t.messageResponses[t.comboID(t.id,s,"responseBox")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,s,"responseBox")]).sort(t.sortMessages),(function(e){return i("div",{key:e,staticClass:"response",class:{your:e.mine}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),i("span",{staticClass:"userId",attrs:{"aria-hidden":"true"}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"timestamp",attrs:{"aria-hidden":"true"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),i("p",{staticClass:"message",attrs:{tabindex:"0",role:"log","aria-label":"Message from "+e.name+" on "+new Date(e.timestamp).toLocaleString()}},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),i("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.unofficialView))])],2):t._e(),t._v(" "),"officialView"===t.currentMode?i("div",{staticClass:"textResponses officialView",attrs:{"aria-live":"polite",role:"log",id:t.comboID(t.id,s,"responseBoxOfficial")}},[t.messageResponses[t.comboID(t.id,s,"responseBoxOfficial")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,s,"responseBoxOfficial")]).sort(t.sortMessages),(function(e){return i("div",{key:e,staticClass:"response",class:{your:e.mine}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),i("span",{staticClass:"userId",attrs:{"aria-hidden":"true"}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"timestamp",attrs:{"aria-hidden":"true"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),i("p",{staticClass:"message",attrs:{tabindex:"0",role:"log","aria-label":"Message from "+e.name+" on "+new Date(e.timestamp).toLocaleString()}},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),i("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.officialView))])],2):t._e(),t._v(" "),"privateView"===t.currentMode?i("div",{staticClass:"textResponses privateView",attrs:{"aria-live":"polite",role:"log",id:t.comboID(t.id,s,"responseBoxPrivate")}},[t.messageResponses[t.comboID(t.id,s,"responseBoxPrivate")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,s,"responseBoxPrivate")]).sort(t.sortMessages),(function(e){return i("div",{key:e,staticClass:"response",class:{your:e.mine}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),i("span",{staticClass:"userId",attrs:{"aria-hidden":"true"}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"timestamp",attrs:{"aria-hidden":"true"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),i("p",{staticClass:"message",attrs:{tabindex:"0",role:"log","aria-label":"Message from "+e.name+" on "+new Date(e.timestamp).toLocaleString()}},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),i("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.privateView))])],2):t._e(),t._v(" "),"teamView"===t.currentMode?i("div",{staticClass:"textResponses teamView",attrs:{"aria-live":"polite",role:"log",id:t.comboID(t.id,s,"responseBoxTeam")}},[t.messageResponses[t.comboID(t.id,s,"responseBoxTeam")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,s,"responseBoxTeam")]).sort(t.sortMessages),(function(e){return i("div",{key:e,staticClass:"response",class:{your:e.mine}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),i("span",{staticClass:"userId",attrs:{"aria-hidden":"true"}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"timestamp",attrs:{"aria-hidden":"true"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),i("p",{staticClass:"message",attrs:{tabindex:"0",role:"log","aria-label":"Message from "+e.name+" on "+new Date(e.timestamp).toLocaleString()}},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),i("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.teamView))])],2):t._e(),t._v(" "),"classView"===t.currentMode?i("div",{staticClass:"textResponses classView",attrs:{"aria-live":"polite",role:"log",id:t.comboID(t.id,s,"responseBoxClass")}},[t.messageResponses[t.comboID(t.id,s,"responseBoxClass")]?t._l(Object.values(t.messageResponses[t.comboID(t.id,s,"responseBoxClass")]).sort(t.sortMessages),(function(e){return i("div",{key:e,staticClass:"response",class:{your:e.mine}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),i("span",{staticClass:"userId",attrs:{"aria-hidden":"true"}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"timestamp",attrs:{"aria-hidden":"true"}},[t._v(t._s(new Date(e.timestamp).toLocaleString()))]),t._v(" "),i("p",{staticClass:"message",attrs:{tabindex:"0",role:"log","aria-label":"Message from "+e.name+" on "+new Date(e.timestamp).toLocaleString()}},[t._v(t._s(e.text))])])})):t._e(),t._v(" "),i("p",{staticClass:"dataEntryTextResponseNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.classView))])],2):t._e()]):t._e(),t._v(" "),"file"===e.type?i("div",{key:e,staticClass:"dataEntryFileInputContainer"},[i("div",{staticClass:"dataEntryFileInputEditContainer",class:e.cssClass},[i("label",[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode?i("div",{staticClass:"dataEntryFileInputDropZone",on:{drop:function(i){i.preventDefault(),t.handleFileDrop(i,t.comboID(t.id,s),e.prompt)}}},[i("input",{ref:"fileInput-"+t.comboID(t.id,s),refInFor:!0,attrs:{"aria-required":"true","aria-label":t.prompt+". Select Files.",required:!!e.required&&"required",oninvalid:t.invalidForm,id:t.comboID(t.id,s),type:"file",multiple:""},on:{change:function(i){t.updateFileModel(i,t.comboID(t.id,s),e.prompt)}}}),t._v(" "),i("i",{staticClass:"fa fa-file-upload fa-3x"}),t._v(" "),i("span",[t._v("Drag and drop files here or "),i("span",{staticClass:"dataEntryFileInputDropZoneLink",on:{click:function(e){t.$refs["fileInput-"+t.comboID(t.id,s)][0].click()}}},[t._v("browse")]),t._v(" your files.")])]):t._e(),t._v(" "),"edit"===t.currentMode&&t.fileUploadModels[t.comboID(t.id,s)]?i("div",{staticClass:"dataEntryFileInputQueuedResponses",attrs:{"aria-live":"polite",role:"log"}},[t._l(t.fileUploadModels[t.comboID(t.id,s)].files,(function(e,o){return i("div",{key:e.name,staticClass:"dataEntryFileInputResponse"},[i("i",{staticClass:"fa fa-file fa-3x dataEntryFileInputResponseIcon"}),t._v(" "),i("div",{staticClass:"dataEntryFileInputResponseTextContainer",attrs:{tabindex:"0",role:"alert"}},[i("span",{staticClass:"dataEntryFileInputResponseText"},[t._v(t._s(e.name))]),t._v(" "),i("span",[t._v(t._s(t.fileSize(e.size)))])]),t._v(" "),i("button",{staticStyle:{background:"transparent"},attrs:{"aria-label":"Remove File"},on:{click:function(e){t.removeFileModel(o,t.comboID(t.id,s))}}},[i("i",{staticClass:"fa fa-times fa-2x dataEntryFileInputResponseDeleteIcon"})])])})),t._v(" "),e.allowMediaUpload?i("span",{staticClass:"dataEntryClickableSpan",attrs:{tabindex:"0"},on:{click:function(i){t.setFormType(s,"text"),t.initTextEntry(t.comboID(t.id,s.toString()),e.prompt)}}},[t._v("Enter Text Response")]):t._e()],2):t._e(),t._v(" "),"privateView"===t.currentMode?i("div",{staticClass:"dataEntryFileInputPreviewContainer",attrs:{"aria-live":"polite",role:"log"}},[t.fileResponses[t.comboID(t.id,s,"responseBoxPrivate")]&&t.fileResponses[t.comboID(t.id,s,"responseBoxPrivate")][t.userProfile.identity]?[t._l(t.fileResponses[t.comboID(t.id,s,"responseBoxPrivate")][t.userProfile.identity].files,(function(e){return[t.fileIsImage(e)?i("img",{key:e,staticClass:"dataEntryFileInputImagePreview",attrs:{src:e.objectUrl}}):t._e(),t._v(" "),t.fileIsVideo(e)?i("video",{key:e,staticClass:"dataEntryFileInputVideoPreview",attrs:{controls:"controls"}},[i("source",{attrs:{src:e.objectUrl,type:e.type}})]):t._e(),t._v(" "),i("div",{key:e,staticClass:"dataEntryFileInputResponse"},[t.fileIsImage(e)||t.fileIsVideo(e)?t._e():i("i",{staticClass:"fa fa-file fa-3x dataEntryFileInputResponseIcon"}),t._v(" "),i("div",{class:{dataEntryFileInputResponseTextContainerMedia:t.fileIsImage(e)||t.fileIsVideo(e),dataEntryFileInputResponseTextContainer:!t.fileIsImage(e)&&!t.fileIsVideo(e)},attrs:{tabindex:"0",role:"alert"}},[i("span",{staticClass:"dataEntryFileInputResponseText"},[t._v(t._s(e.name))]),t._v(" "),i("span",[t._v(t._s(t.fileSize(e.size)))])]),t._v(" "),t.fileIsImage(e)||t.fileIsVideo(e)?t._e():i("button",{attrs:{"aria-label":"Download file"},on:{click:function(i){return t.downloadFile(e)}}},[i("i",{staticClass:"fa fa-download fa-2x dataEntryFileInputDownloadIcon"})])]),t._v(" "),i("hr",{key:e})]}))]:t._e(),t._v(" "),0===t.fileUploadModels[t.comboID(t.id,s)].files.length?i("p",{staticClass:"dataEntryFileUploadNoData"},[t._v(t._s(t.modeTextMap.textResponseNoData.privateView))]):t._e()],2):t._e()])]):t._e(),t._v(" "),"multipleChoice"===e.type?i("div",{key:e,staticClass:"dataEntryMultiChoiceContainer",attrs:{"aria-live":"polite"}},[i("div",{staticClass:"dataEntryMultiChoicePrompt"},[t._v(t._s(e.prompt?e.prompt.replace(/\&/g," and "):""))]),t._v(" "),"edit"===t.currentMode?i("div",{staticClass:"dataEntryMultiChoiceButtonsContainer",attrs:{role:"group","aria-label":t.prompt,id:t.comboID(t.id,s)}},t._l(e.responses,(function(o,a){return i("button",{key:o,staticClass:"dataEntryMultiChoiceButton edit",class:{active:t.activeMultiChoiceButton[t.comboID(t.id,s)]&&t.activeMultiChoiceButton[t.comboID(t.id,s)].includes(a)},attrs:{role:"status","aria-label":t.activeMultiChoiceButton[t.comboID(t.id,s)]&&t.activeMultiChoiceButton[t.comboID(t.id,s)].includes(a)?"Selected":"Not selected",type:"button","data-prompt":e.prompt,"data-index":a,"data-responseBox":t.comboID(t.id,s,"responseBox"),"data-responseBoxGraph":t.comboID(t.id,s,"responseBox","graph"),"data-responseBoxTeamGraph":t.comboID(t.id,s,"responseBoxTeam","graph"),"data-responseBoxClassGraph":t.comboID(t.id,s,"responseBoxClass","graph"),"data-responseBoxTeam":t.comboID(t.id,s,"responseBoxTeam"),"data-responseBoxClass":t.comboID(t.id,s,"responseBoxClass"),"data-useGraphView":t.polling},on:{click:function(i){return t.setMultiChoiceResponse(s,a,e,o)}}},[t._v("\n                                "+t._s(o.replace(/<br\/>/g,t.brTag).replace(/\&/g," and "))+"\n                            ")])})),0):"unofficialView"!==t.currentMode||t.polling?"classView"===t.currentMode&&t.polling?i("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{role:"log",id:t.comboID(t.id,s,"responseBoxClass","graph")}},t._l(e.responses,(function(e,o){return i("div",{key:o,staticClass:"classView dataEntryMultiChoiceResponse",attrs:{"data-index":o}},[i("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[i("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[i("span",{attrs:{"aria-hidden":"true"}},[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),i("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,s,"responseBoxClass","graph"),o)}})])]),t._v(" "),i("span",{staticClass:"dataEntryMultiChoiceResponseCount",attrs:{role:"alert","aria-label":e+" count. "}},[t._v(t._s(t.pollCounts[t.comboID(t.id,s,"responseBoxClass","graph")]&&t.pollCounts[t.comboID(t.id,s,"responseBoxClass","graph")][o]?t.pollCounts[t.comboID(t.id,s,"responseBoxClass","graph")][o]:0))])])])})),0):"unofficialView"===t.currentMode&&t.polling?i("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{role:"log",id:t.comboID(t.id,s,"responseBox","graph")}},t._l(e.responses,(function(e,o){return i("div",{key:o,staticClass:"unofficialView dataEntryMultiChoiceResponse",attrs:{"data-index":o}},[i("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[i("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[i("span",{attrs:{"aria-hidden":"true"}},[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),i("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,s,"responseBox","graph"),o)}})])]),t._v(" "),i("span",{staticClass:"dataEntryMultiChoiceResponseCount",attrs:{role:"alert","aria-label":e+" count. "}},[t._v(t._s(t.pollCounts[t.comboID(t.id,s,"responseBox","graph")]&&t.pollCounts[t.comboID(t.id,s,"responseBox","graph")][o]?t.pollCounts[t.comboID(t.id,s,"responseBox","graph")][o]:0))])])])})),0):"teamView"===t.currentMode&&t.polling?i("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{role:"log",id:t.comboID(t.id,s,"responseBoxTeam","graph")}},t._l(e.responses,(function(e,o){return i("div",{key:o,staticClass:"teamView dataEntryMultiChoiceResponse",attrs:{"aria-label":"","data-index":o}},[i("div",{staticClass:"dataEntryMultiChoiceResponseContent"},[i("div",{staticClass:"dataEntryMultiChoiceResponseTextContainer"},[i("span",{attrs:{"aria-hidden":"true"}},[t._v(t._s(e.replace(/<br\/>/g,t.brTag).replace(/\&/g," and ")))])]),t._v(" "),i("div",{staticClass:"dataEntryMultiChoiceResponseGraphContainer"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphParentBar"},[i("div",{staticClass:"dataEntryMultiChoiceResponseGraphFillBar",style:{width:t.getPollWidth(t.comboID(t.id,s,"responseBoxTeam","graph"),o)}})])]),t._v(" "),i("span",{staticClass:"dataEntryMultiChoiceResponseCount",attrs:{role:"alert","aria-label":e+" count. "}},[t._v(t._s(t.pollCounts[t.comboID(t.id,s,"responseBoxTeam","graph")]&&t.pollCounts[t.comboID(t.id,s,"responseBoxTeam","graph")][o]?t.pollCounts[t.comboID(t.id,s,"responseBoxTeam","graph")][o]:0))])])])})),0):"teamView"!==t.currentMode||t.polling?"classView"!==t.currentMode||t.polling?t._e():i("div",{staticClass:"textResponses classView",attrs:{id:t.comboID(t.id,s,"responseBoxClass")}}):i("div",{staticClass:"textResponses teamView",attrs:{id:t.comboID(t.id,s,"responseBoxTeam")}}):i("div",{staticClass:"dataEntryMultiChoiceResponseContainer",attrs:{id:t.comboID(t.id,s,"responseBox")}})]):t._e()]}))],2),t._v(" "),"edit"===t.currentMode?i("div",{staticClass:"dataEntryFooter"},[t.enabledFooterButtons.formSubmit?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmit()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitPrivate?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitPrivate()}}},[t._v(t._s(t.formSubmitPrivateButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitTeam?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitTeam()}}},[t._v(t._s(t.formSubmitTeamButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitClass?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitClass()}}},[t._v(t._s(t.formSubmitClassButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons.formSubmitEmail?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitEmail()}}},[t._v(t._s(t.formSubmitEmailButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons["formSubmitTeam+All"]?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitTeamAll()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e(),t._v(" "),t.enabledFooterButtons["formSubmitClass+All"]?i("button",{staticClass:"dataEntryFormSubmit",attrs:{tabindex:"0"},on:{click:function(e){return t.formSubmitClassAll()}}},[t._v(t._s(t.formSubmitButtonText))]):t._e()]):t._e()])])}),[],!1,null,null,null).exports;i.d(e,"insertExtensions",(function(){return p})),i.d(e,"createDataEntry",(function(){return u}));var n=window.parent&&window.parent.PeBL?window.parent.PeBL:window.PeBL?window.PeBL:null,r=window.parent.READIUM,l=window.parent.Configuration,d=window.parent.Lightbox;function p(){jQuery('.dataEntryExtension, .peblExtension[data-peblextension="dataentry"], .peblExtension[data-peblExtension="dataentry"], .peblExtension[data-peblExtension="dataentrypoll"], .peblExtension[data-peblextension="dataentrypoll"], .peblExtension[data-peblExtension="dataentrytext"], .peblExtension[data-peblextension="dataentrytext"], .peblExtension[data-peblExtension="dataentryfile"], .peblExtension[data-peblextension="dataentryfile"]').each((function(){var t=this.getAttribute("data-prompt"),e=this.getAttribute("data-id"),i=this.getAttribute("id");e||(e=i);var s=JSON.parse(this.getAttribute("data-forms")),o=this.getAttribute("data-sharing"),a=this.getAttribute("data-displayMode")||jQuery(this)[0].getAttribute("data-displaymode"),n=this.hasAttribute("data-polling")?jQuery(this)[0].getAttribute("data-polling"):"false",r=this.hasAttribute("data-multiselectpolling")?this.getAttribute("data-multiselectpolling"):"1",l=this.hasAttribute("data-useConfig")?jQuery(this)[0].getAttribute("data-useConfig"):"false",d=this.hasAttribute("data-closeable")?this.getAttribute("data-closeable"):"false",p=this.hasAttribute("data-propertiesobject")?this.getAttribute("data-propertiesobject"):void 0,c=this.hasAttribute("data-authoringid")?this.getAttribute("data-authoringid"):void 0;u('[id="'+i+'"]',i,t,e,s,o,a,n,parseInt(r),l,d,p,c)}))}function u(t,e,i,s,p,u,c,h,m,b,g,f,v){new o.a({el:t,render:t=>t(a,{props:{globalPebl:n,globalReadium:r,globalConfiguration:l,globalLightbox:d,insertID:e,prompt:i,id:s,forms:p,sharing:u,displayMode:c,polling:h,multiSelectPolling:m,useConfig:b,closeable:g,propertiesObject:f,authoringId:v}})})}jQuery(document).ready((function(){window.parent.PeBLConfig&&window.parent.PeBLConfig.isAuthoring?document.addEventListener("pebleditorready",()=>{p()}):p()}))},function(t,e,i){"use strict";function s(t,e){for(var i=[],s={},o=0;o<e.length;o++){var a=e[o],n=a[0],r={id:t+":"+o,css:a[1],media:a[2],sourceMap:a[3]};s[n]?s[n].parts.push(r):i.push(s[n]={id:n,parts:[r]})}return i}i.r(e),i.d(e,"default",(function(){return h}));var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},n=o&&(document.head||document.getElementsByTagName("head")[0]),r=null,l=0,d=!1,p=function(){},u=null,c="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,i,o){d=i,u=o||{};var n=s(t,e);return m(n),function(e){for(var i=[],o=0;o<n.length;o++){var r=n[o];(l=a[r.id]).refs--,i.push(l)}e?m(n=s(t,e)):n=[];for(o=0;o<i.length;o++){var l;if(0===(l=i[o]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete a[l.id]}}}}function m(t){for(var e=0;e<t.length;e++){var i=t[e],s=a[i.id];if(s){s.refs++;for(var o=0;o<s.parts.length;o++)s.parts[o](i.parts[o]);for(;o<i.parts.length;o++)s.parts.push(g(i.parts[o]));s.parts.length>i.parts.length&&(s.parts.length=i.parts.length)}else{var n=[];for(o=0;o<i.parts.length;o++)n.push(g(i.parts[o]));a[i.id]={id:i.id,refs:1,parts:n}}}}function b(){var t=document.createElement("style");return t.type="text/css",n.appendChild(t),t}function g(t){var e,i,s=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(s){if(d)return p;s.parentNode.removeChild(s)}if(c){var o=l++;s=r||(r=b()),e=x.bind(null,s,o,!1),i=x.bind(null,s,o,!0)}else s=b(),e=y.bind(null,s),i=function(){s.parentNode.removeChild(s)};return e(t),function(s){if(s){if(s.css===t.css&&s.media===t.media&&s.sourceMap===t.sourceMap)return;e(t=s)}else i()}}var f,v=(f=[],function(t,e){return f[t]=e,f.filter(Boolean).join("\n")});function x(t,e,i,s){var o=i?"":s.css;if(t.styleSheet)t.styleSheet.cssText=v(e,o);else{var a=document.createTextNode(o),n=t.childNodes;n[e]&&t.removeChild(n[e]),n.length?t.insertBefore(a,n[e]):t.appendChild(a)}}function y(t,e){var i=e.css,s=e.media,o=e.sourceMap;if(s&&t.setAttribute("media",s),u.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),o&&(i+="\n/*# sourceURL="+o.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}}]);